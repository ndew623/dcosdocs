<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Multiple Zones - D2iQ Docs</title><meta name="description" content="Setting up multiple-zone configurations"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="spherer"><div class="chooser-current"><a class="chooser-title">Mesosphere</a><svg class="chooser-svg" id="spherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="spherer-list"><li class="chooser-list-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="chooser-list-item"><a href="/mesosphere/dcos/services">DC/OS Services</a></li></ul></div><div class="chooser" id="ks"><div class="chooser-current"><a class="chooser-title">DKP</a><svg class="chooser-svg" id="kspherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="kspherer-list"><li class="chooser-list-item"><a href="/dkp/konvoy">Konvoy</a></li><li class="chooser-list-item"><a href="/dkp/kommander">Kommander</a></li><li class="chooser-list-item"><a href="/dkp/dispatch">Dispatch</a></li><li class="chooser-list-item"><a href="/dkp/kaptain">Kaptain</a></li></ul></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/mesosphere/dcos/cn/1.13/installing/production/advanced-configuration/configuring-zones-regions/multi-zone">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 1.13"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/mesosphere/dcos/2.2/installing/production/advanced-configuration/configuring-zones-regions/multi-zone">Mesosphere DC/OS 2.2.0</a></li><li><a href="/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuring-zones-regions/multi-zone">Mesosphere DC/OS 2.1.0</a></li><li><a href="/mesosphere/dcos/2.0/installing/production/advanced-configuration/configuring-zones-regions/multi-zone">Mesosphere DC/OS 2.0</a></li><li><a href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-zones-regions/multi-zone">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 1.13</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/mesosphere/dcos/1.13/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/overview/"><i data-feather="chevron-right"></i>Overview</a></li><li class="active"><a class="d0" href="/mesosphere/dcos/1.13/installing/"><i data-feather="chevron-right"></i>Installing</a></li><ul><li><a class="d1" href="/mesosphere/dcos/1.13/installing/evaluation/"><i data-feather="chevron-right"></i>Cloud Installation</a></li><li class="active"><a class="d1" href="/mesosphere/dcos/1.13/installing/production/"><i data-feather="chevron-right"></i>On-Prem Installation</a></li><ul><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/virt-infra/">Virtual Infrastructure</a></li><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/system-requirements/"><i data-feather="chevron-right"></i>System Requirements</a></li><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/deploying-dcos/"><i data-feather="chevron-right"></i>Deploying DC/OS</a></li><li class="active"><a class="d2" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/"><i data-feather="chevron-right"></i>Advanced Configuration</a></li><ul><li><a class="d3" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuration-reference/">Configuration Reference</a></li><li><a class="d3" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-gpu-nodes/">Configuring GPU nodes</a></li><li class="active"><a class="d3" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-zones-regions/"><i data-feather="chevron-right"></i>Configuring Zones and Regions</a></li><ul><li class="active active-on"><a class="d4" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-zones-regions/multi-zone/">Multiple Zones</a></li><li><a class="d4" href="/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-zones-regions/multi-region/">Multiple Regions</a></li></ul></ul><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/dcos-ansible/"><i data-feather="chevron-right"></i>DC/OS with Ansible</a></li><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/patching/">Patching</a></li><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/upgrading/">Upgrading</a></li><li><a class="d2" href="/mesosphere/dcos/1.13/installing/production/uninstalling/">Uninstalling</a></li></ul><li><a class="d1" href="/mesosphere/dcos/1.13/installing/installation-faq/">Frequently Asked Questions</a></li><li><a class="d1" href="/mesosphere/dcos/1.13/installing/troubleshooting/">Troubleshooting</a></li></ul><li><a class="d0" href="/mesosphere/dcos/1.13/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/mesosphere/dcos/1.13/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Multiple Zones</h1></div><h4 class="content__header-description">Setting up multiple-zone configurations</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-zones-regions/multi-zone/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><p>DC/OS supports multiple zone (multi-AZ) configurations. This page describes the setup recommendations and caveats. A typical DC/OS cluster has all master and agent nodes in the same zone. The cost of having masters spread across zones usually outweighs the benefits.</p>
<p><strong>Important:</strong></p>
<ul>
<li>A typical DC/OS cluster has all master and agent nodes in the same zone. The cost of having masters spread across zones usually outweighs the benefits.</li>
<li>The following multi-AZ setups have not been explicitly tested or verified.</li>
</ul>
<h1 id="single-zone-masters-and-cross-zone-agents-within-a-region"><a class="content__anchor" href="#single-zone-masters-and-cross-zone-agents-within-a-region" aria-hidden="true"><i data-feather="bookmark"></i></a>Single-Zone Masters and Cross-Zone Agents within a Region</h1>
<p>All DC/OS masters are present in a single zone, but the agents can span multiple zones within that region.</p>
<h2 id="recommendations-and-caveats"><a class="content__anchor" href="#recommendations-and-caveats" aria-hidden="true"><i data-feather="bookmark"></i></a>Recommendations and Caveats</h2>
<ul>
<li>If you are using a rack, distribute masters across the racks.</li>
<li>All agents within a zone should be tagged with an attribute (for example, <code>zone:us-east-1a</code>) to easily constrain apps and services to specific zones.</li>
<li>Any DC/OS service schedulers should be scheduled to the same zone as masters (for example, by using constraints).</li>
<li>For ease of failover of apps between zones, ensure that apps do not depend on zone-level resources or that those resources are properly replicated and migrated on failover. Also, ensure there is enough spare capacity in each zone to handle failover workload.</li>
<li>If an agent-only zone fails, all other zones will continue to function normally. Apps from the failed zone will be rescheduled into other zones as long as there is spare capacity.</li>
<li>If an agent-only zone gets partitioned from the masters-containing zone, apps will continue to run in that zone but schedulers might “reschedule” copies of the apps into other zones.</li>
<li>If a masters-containing zone fails, apps in other zones continue to run. However, app updates or rescheduling of failed apps is not possible until a quorum of masters come up.</li>
<li>The total cross-sectional bandwidth between zones is limited. This means that performance can be degraded for data (I/O) intensive DC/OS services if deployed across zones.</li>
</ul>
<h1 id="cross-zone-masters-and-cross-zone-agents-within-a-region"><a class="content__anchor" href="#cross-zone-masters-and-cross-zone-agents-within-a-region" aria-hidden="true"><i data-feather="bookmark"></i></a>Cross-Zone Masters and Cross-Zone Agents within a Region</h1>
<p>DC/OS masters and agents span multiple zones within a region.</p>
<h2 id="recommendations-and-caveats-2"><a class="content__anchor" href="#recommendations-and-caveats-2" aria-hidden="true"><i data-feather="bookmark"></i></a>Recommendations and Caveats</h2>
<ul>
<li>Quorum size and placement of masters should tolerate zone failure. For example, for a quorum size of two, place each of the three masters in a separate zone. Do not place a quorum of masters into a single zone.</li>
<li>Quorum size and placement of masters should tolerate zone failure for DC/OS service schedulers. This can be achieved using constraints.</li>
<li>For ease of failover of apps between zones, ensure that either apps do not depend on zone level resources or that those resources are properly replicated and migrated on failover.</li>
<li>If a zone that contains masters fails, and if scheduling constraints can be met and there is spare capacity, the apps that are scheduled to that zone will be rescheduled to other zones. All DC/OS components should work normally if a quorum of masters is alive.</li>
<li>Because networking partitions are more likely across zones, masters could end up in split-brain scenario. For example: Two different masters think they are the leader at the same time. This is typically harmless because only one leader is allowed to make modifiable actions like registering or shutting down agents.</li>
<li>The total cross-sectional bandwidth between zones is limited. This means that performance can be degraded for data (I/O) intensive DC/OS services if deployed across zones.</li>
</ul>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#single-zone-masters-and-cross-zone-agents-within-a-region">Single-Zone Masters and Cross-Zone Agents within a Region</a></li><li class="content__sections-item content__sections-item--h2"><a href="#recommendations-and-caveats">Recommendations and Caveats</a></li><li class="content__sections-item content__sections-item--h1"><a href="#cross-zone-masters-and-cross-zone-agents-within-a-region">Cross-Zone Masters and Cross-Zone Agents within a Region</a></li><li class="content__sections-item content__sections-item--h2"><a href="#recommendations-and-caveats-2">Recommendations and Caveats</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>