<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Tutorial -  Exposing Apps Publicly - D2iQ Docs</title><meta name="description" content="Part 6 of the DC/OS 101 tutorial"><link rel="apple-touch-icon" sizes="180x180" href="/dcosdocs/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/dcosdocs/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/dcosdocs/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/dcosdocs/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/dcosdocs/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/dcosdocs/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/2.0/tutorials/dcos-101/marathon-lb">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 2.0"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/2.2/tutorials/dcos-101/marathon-lb">Mesosphere DC/OS 2.2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.1/tutorials/dcos-101/marathon-lb">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/marathon-lb">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/1.13/tutorials/dcos-101/marathon-lb">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 2.0</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/overview/"><i data-feather="chevron-right"></i>Overview</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/installing/"><i data-feather="chevron-right"></i>Installing</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/multi-tenancy/"><i data-feather="chevron-right"></i>Multi-Tenancy for DC/OS Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li class="active"><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><ul><li class="active"><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/"><i data-feather="chevron-right"></i>DC/OS 101</a></li><ul><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/cli/">First Steps</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/redis-package/">Installing the First Package</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/app1/">Deploying First Application</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/service-discovery/">Service Discovery</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/app2/">Native Applications</a></li><li class="active active-on"><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/marathon-lb/">Exposing Apps Publicly</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/resources/">Understanding Resources</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/loadbalancing/">Load-Balancing</a></li></ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/create-service/">Creating and Running a Service</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/stateful-services/">Running Stateful Services on DC/OS</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/autoscaling/"><i data-feather="chevron-right"></i>Autoscaling with Marathon</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/iot_pipeline/">Deploying a Load-Balanced Data Pipeline</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/deploy-on-marathon/">Deploying Marathon Apps with Jenkins</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/task-labels/">Labeling Tasks and Jobs</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-debug/"><i data-feather="chevron-right"></i>Debugging Applications on DC/OS</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.0/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Tutorial -  Exposing Apps Publicly</h1></div><h4 class="content__header-description">Part 6 of the DC/OS 101 tutorial</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/marathon-lb/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><!-- This disclaimer should be included at the beginning of each page of a tutorial. -->
<p class="message--important"><strong>IMPORTANT: </strong>Tutorials are intended to give you hands-on experience working with a limited set of DC/OS features with no implied or explicit warranty of any kind. None of the information provided--including sample scripts, commands, or applications--is officially supported by Mesosphere. You should not use this information in a production environment without independent testing and validation.</p>
<p>Welcome to part 6 of the DC/OS 101 Tutorial.</p>
<h1 id="prerequisites"><a class="content__anchor" href="#prerequisites" aria-hidden="true"><i data-feather="bookmark"></i></a>Prerequisites</h1>
<ul>
<li>A <a href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/cli/">running DC/OS cluster</a> with <a href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/cli/">the DC/OS CLI installed</a>.</li>
<li><a href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/app2/">app2</a> deployed and running in your cluster.</li>
</ul>
<h1 id="objective"><a class="content__anchor" href="#objective" aria-hidden="true"><i data-feather="bookmark"></i></a>Objective</h1>
<p>In this section you will make app2 available from outside the cluster by running it on a public agent node with Marathon-LB.</p>
<h1 id="steps"><a class="content__anchor" href="#steps" aria-hidden="true"><i data-feather="bookmark"></i></a>Steps</h1>
<p>DC/OS has two different node types:</p>
<ol>
<li>Private agent nodes</li>
<li>Public agent nodes</li>
</ol>
<p>Private agent nodes are usually only accessible inside the cluster, while public agent nodes allow for ingress access from outside the cluster.</p>
<p>By default, Marathon starts applications and services on private agent nodes, which cannot be accessed from the outside the cluster. To expose an app to the outside you usually use a load balancer running on one of the public nodes.</p>
<p>You will revisit the topic of load balancing and the different choices for load balancers later in this tutorial, but for now, you will use <a href="/dcosdocs/mesosphere/dcos/2.0/tutorials/dcos-101/loadbalancing/">Marathon-LB</a> as the load balancer. Marathon-LB uses <a href="http://www.haproxy.org/">HA-Proxy</a> on a public agent node to provide external access and load balancing for applications running internally in the cluster.</p>
<ul>
<li>
<p>Install Marathon-LB: <code>dcos package install marathon-lb</code></p>
</li>
<li>
<p>Check that it is running using <code>dcos task</code> and identify the IP address of the public agent node (Host) where Marathon-LB is running</p>
<p class="message--warning"><strong>WARNING: </strong>If you started your cluster using a cloud provider (especially AWS) <code>dcos task</code> might show you the private IP address of the host, which is not resolvable from outside the cluster. If the marathon-lb task has an <a href="https://en.wikipedia.org/wiki/Private_network"> RFC1918 address</a> beginning with 192.168 or 10, then this is the private IP address.</p>
<p>In that case, you need to retrieve the public IP from your cloud provider. For AWS, go to the EC2 dashboard and search using the search box for the private IP assigned to the marathon-lb task shown by <code>dcos task</code>. The public IP will be listed in the IPv4 Public IP field for the returned instance.</p>
</li>
<li>
<p>Connect to the webapp (from your local machine) via <code>&lt;Public IP&gt;:10000</code>. You should see a rendered version of the web page including the physical node and port app2 is running on.</p>
</li>
<li>
<p>Use the web form to add a new Key:Value pair</p>
</li>
<li>
<p>You can verify the new key was added in two ways:</p>
<ol>
<li>Check the total number of keys using app1: <code>dcos task log app1</code></li>
<li>Check Redis directly
<ul>
<li>
<p><a href="/dcosdocs/mesosphere/dcos/2.0/administering-clusters/sshcluster/">SSH</a> into node where Redis is running:</p>
<pre><code class="language-bash">dcos node ssh --master-proxy --mesos-id=$(dcos task  redis --json |  jq -r '.[] | .slave_id')
</code></pre>
</li>
<li>
<p>Because Redis is running in a Docker container you can list all the Docker containers using <code>docker ps</code> and get the ContainerID of the Redis task.</p>
</li>
<li>
<p>Create a bash session in the running container using the ContainerID from the previous step: <code>sudo docker exec -i -t CONTAINER_ID /bin/bash</code>.</p>
</li>
<li>
<p>Start the Redis CLI: <code>redis-cli</code>.</p>
</li>
<li>
<p>Check the value is there: <code>get &lt;newkey&gt;</code>.</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h1 id="outcome"><a class="content__anchor" href="#outcome" aria-hidden="true"><i data-feather="bookmark"></i></a>Outcome</h1>
<p>Congratulations! You have used Marathon-LB to expose your application to the public and added a new key to Redis using the web frontend.</p>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#prerequisites">Prerequisites</a></li><li class="content__sections-item content__sections-item--h1"><a href="#objective">Objective</a></li><li class="content__sections-item content__sections-item--h1"><a href="#steps">Steps</a></li><li class="content__sections-item content__sections-item--h1"><a href="#outcome">Outcome</a></li></ul></div></aside></main></div></div><script src="/dcosdocs/assets/js/jquery-3.2.1.js"></script><script src="/dcosdocs/assets/js/clipboard.js"></script><script src="/dcosdocs/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>