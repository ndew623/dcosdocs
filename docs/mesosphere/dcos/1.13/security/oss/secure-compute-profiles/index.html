<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Secure computing profiles - D2iQ Docs</title><meta name="description" content="Describes how to configure DC/OS to work with Linux secure computing (seccomp) profiles"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/dcosdocs/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="spherer"><div class="chooser-current"><a class="chooser-title">Mesosphere</a><svg class="chooser-svg" id="spherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="spherer-list"><li class="chooser-list-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li></ul></div><div class="chooser" id="ks"><div class="chooser-current"><a class="chooser-title">DKP</a><svg class="chooser-svg" id="kspherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="kspherer-list"><li class="chooser-list-item"><a href="/dkp/konvoy">Konvoy</a></li><li class="chooser-list-item"><a href="/dkp/kommander">Kommander</a></li><li class="chooser-list-item"><a href="/dkp/dispatch">Dispatch</a></li><li class="chooser-list-item"><a href="/dkp/kaptain">Kaptain</a></li></ul></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/oss/secure-compute-profiles">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 1.13"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/2.2/security/oss/secure-compute-profiles">Mesosphere DC/OS 2.2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.1/security/oss/secure-compute-profiles">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.0/security/oss/secure-compute-profiles">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/1.13/security/oss/secure-compute-profiles">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 1.13</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/overview/"><i data-feather="chevron-right"></i>Overview</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/installing/"><i data-feather="chevron-right"></i>Installing</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li class="active"><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/security/"><i data-feather="chevron-right"></i>Security</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/security/ent/"><i data-feather="chevron-right"></i>DC/OS Enterprise Security</a></li><li class="active"><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/"><i data-feather="chevron-right"></i>DC/OS Open Source Security</a></li><ul><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/user-account-management/"><i data-feather="chevron-right"></i>User Account Management</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/login/"><i data-feather="chevron-right"></i>Login</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/authentication/"><i data-feather="chevron-right"></i>Authentication</a></li><li class="active active-on"><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/secure-compute-profiles/">Secure computing profiles</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/iam-api/">Identity and Access Management API</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/security/oss/haproxy-adminrouter/">HAProxy and Admin Router</a></li></ul></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2021 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Secure computing profiles</h1><p class="badge badge--content-header badge--enterprise">ENTERPRISE</p></div><h4 class="content__header-description">Describes how to configure DC/OS to work with Linux secure computing (seccomp) profiles</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/1.13/security/oss/secure-compute-profiles/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><!-- The source repository for this topic is https://github.com/dcos/dcos-docs-site -->
<p>Secure computing mode (seccomp) is a Linux kernel feature used to restrict the actions available within a running container. The seccomp() system call operates on the seccomp state of the calling process. You can use this feature to restrict your application’s access to the underlying system.</p>
<p>Seccomp support in DC/OS is based on Mesos 1.8 which <a href="http://mesos.apache.org/documentation/latest/isolators/linux-seccomp/">introduces the ability to configure seccomp</a> through the UCR containerizer to provide a higher degree of isolation and security to services deployed on DC/OS. The default seccomp profile within DC/OS provides a reasonable default for running containers by disabling more than 300 system calls.</p>
<h1 id="enabling-and-disabling-secure-computing-mode"><a class="content__anchor" href="#enabling-and-disabling-secure-computing-mode" aria-hidden="true"><i data-feather="bookmark"></i></a>Enabling and disabling secure computing mode</h1>
<p>By default, DC/OS is installed with secure computing mode disabled. You can opt-in of using seccomp by installing DC/OS with <code>mesos_seccomp_enabled=true</code>. Before opting in, however, keep in mind that it is important for the installation of each agent to be consistent with every other agent in the cluster. Deviating from this strategy should only be done by advanced users.</p>
<p>If you enable seccomp for a DC/OS cluster, all tasks start under seccomp control using the default seccomp profile unless you explicitly configure tasks to override the default behavior.</p>
<h1 id="managing-seccomp-profiles"><a class="content__anchor" href="#managing-seccomp-profiles" aria-hidden="true"><i data-feather="bookmark"></i></a>Managing seccomp profiles</h1>
<p>DC/OS uses the <code>/etc/dcos/mesos/seccomp/</code> folder for managing seccomp profiles and provides a default profile named ‘default.json’ that defines <a href="https://github.com/dcos/dcos/blob/113b8abacfd6d517594f329b621aaf4641b535e7/gen/dcos-config.yaml#L532-L838">306 restricted system commands</a>.</p>
<p>In addition to the default profile, it is possible to create any number of additional profiles. The name of the file that defines a profile is considered the profile name. It is important that if additional profiles are added to an agent that the same profile is shared on all agents in the cluster.</p>
<h1 id="restarting-agents-to-use-the-seccomp-profile"><a class="content__anchor" href="#restarting-agents-to-use-the-seccomp-profile" aria-hidden="true"><i data-feather="bookmark"></i></a>Restarting agents to use the seccomp profile</h1>
<p>To make a seccomp profile available on a DC/OS cluster with previously-deployed agents, keep the following guidelines in mind:</p>
<ul>
<li>If you enable seccomp on a new or existing DC/OS cluster, the agent processes must be restarted for the seccomp profile configuration to take effect.</li>
<li>If you are upgrading an agent from a DC/OS version without seccomp to a DC/OS version with seccomp, all tasks on that agent must be restarted for them to run under the seccomp profile.</li>
<li>If you choose to add profiles to the seccomp folder on a DC/OS cluster where seccomp is already enabled, those profiles are available to use without restarting the agent.</li>
</ul>
<h1 id="running-services-under-seccomp"><a class="content__anchor" href="#running-services-under-seccomp" aria-hidden="true"><i data-feather="bookmark"></i></a>Running services under seccomp</h1>
<p>When seccomp is enabled on DC/OS, all newly-created containers running under UCR are started under the default seccomp profile. Using the deafult profile does not require any changes to the service configuration. Using the seccomp profile is not a configuration option when running services with the Docker containerizer.</p>
<p>It is possible to have a service opt-out of running under seccomp. For a Marathon-defined service, this is accomplished by defining <code>unconfined=true</code> in the <code>seccomp</code> object under the <code>LinuxInfo</code> configuration setting for a container. For example:</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;/mesos-seccomp-app&quot;,
  &quot;cmd&quot;: &quot;sleep 1000&quot;,
  &quot;cpus&quot;: 0.5,
  &quot;mem&quot;: 32,
  &quot;container&quot;: {
    &quot;type&quot;: &quot;MESOS&quot;,
    &quot;linuxInfo&quot;: {
      &quot;seccomp&quot;: {
        &quot;unconfined&quot;: true
      }
    }
  }
}
</code></pre>
<p>By configuring a service definition with an <code>unconfined</code> seccomp setting, the container will NOT run under seccomp. This will allow this container to execute any syscall that might have been restricted by the default seccomp profile.</p>
<p>It is also possible to have a service definition run under a different seccomp profile other than the default. This is accomplished by specifying the profile name in the seccomp definition for the service definition. For example:</p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;/mesos-seccomp-app&quot;,
  &quot;cmd&quot;: &quot;sleep 1000&quot;,
  &quot;cpus&quot;: 0.5,
  &quot;mem&quot;: 32,
  &quot;container&quot;: {
    &quot;type&quot;: &quot;MESOS&quot;,
    &quot;linuxInfo&quot;: {
      &quot;seccomp&quot;: {
        &quot;profileName&quot;: &quot;relaxed.json&quot;,
        &quot;unconfined&quot; : false
      }
    }
  }
}
</code></pre>
<p>This service definition expects that any agent it might launch on has a seccomp profile named <code>relaxed.json</code>. When this container starts on that agent, it runs under seccomp control and the estrictions defined in the <code>relaxed.json</code> profile configuration. In this example, the service is not be restricted by the configuration defined in the <code>default.json</code> seccomp profile. Instead, the service runs under the restrictions defined in the custom <code>relaxed.json</code> profile.</p>
<h1 id="consequence-of-running-under-seccomp"><a class="content__anchor" href="#consequence-of-running-under-seccomp" aria-hidden="true"><i data-feather="bookmark"></i></a>Consequence of running under seccomp</h1>
<p>Seccomp is a security mechanism that reduces the surface area of attack on a system by restricting what syscalls are allowed from inside the container. While a container is running under seccomp restrictions, if a restricted call is attempted, the result is the task process will fail. It is up to the recovery mechanism of the scheduler to determine what happens next. For example, Marathon will reschedule the task based on the task failure and Metronome will log the job run as failed but may or may not reschedule the job run based on the job retry configuration settings.</p>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#enabling-and-disabling-secure-computing-mode">Enabling and disabling secure computing mode</a></li><li class="content__sections-item content__sections-item--h1"><a href="#managing-seccomp-profiles">Managing seccomp profiles</a></li><li class="content__sections-item content__sections-item--h1"><a href="#restarting-agents-to-use-the-seccomp-profile">Restarting agents to use the seccomp profile</a></li><li class="content__sections-item content__sections-item--h1"><a href="#running-services-under-seccomp">Running services under seccomp</a></li><li class="content__sections-item content__sections-item--h1"><a href="#consequence-of-running-under-seccomp">Consequence of running under seccomp</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>