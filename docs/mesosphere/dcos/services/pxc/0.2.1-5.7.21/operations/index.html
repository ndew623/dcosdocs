<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Operations - D2iQ Docs</title><meta name="description" content="Managing, repairing, and monitoring the service"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>Pxc Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="spherer"><div class="chooser-current"><a class="chooser-title">Mesosphere</a><svg class="chooser-svg" id="spherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="spherer-list"><li class="chooser-list-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li></ul></div><div class="chooser" id="ks"><div class="chooser-current"><a class="chooser-title">DKP</a><svg class="chooser-svg" id="kspherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="kspherer-list"><li class="chooser-list-item"><a href="/dkp/konvoy">Konvoy</a></li><li class="chooser-list-item"><a href="/dkp/konvoy/partner-solutions">Partner Solutions</a></li><li class="chooser-list-item"><a href="/dkp/kommander">Kommander</a></li><li class="chooser-list-item"><a href="/dkp/dispatch">Dispatch</a></li><li class="chooser-list-item"><a href="/dkp/kaptain">Kaptain</a></li></ul></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/services">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS Services"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/konvoy/partner-solutions">Partner Solutions</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations">Percona XtraDB Cluster 0.2.1-5.7.21</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.0-5.7.21/operations">Percona XtraDB Cluster 0.2.0-5.7.21</a></li></ul><div class="toggle"><p><span class="title">Pxc</span><span class="version"> 0.2.1-5.7.21</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/release-notes/">Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/getting-started/">Getting Started</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/overview/">Overview</a></li><li class="active active-on"><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/"><i data-feather="chevron-right"></i>Operations</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/install/">Install</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/disaster-recovery/"><i data-feather="chevron-right"></i>Disaster Recovery</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/troubleshooting/">Troubleshooting</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/uninstall/">Uninstalling</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/cli-reference/">CLI Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/quick-start/">Quick Start</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/limitations/">Limitations</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/supported-versions/">Supported Versions</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2021 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Operations</h1></div><h4 class="content__header-description">Managing, repairing, and monitoring the service</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li><li class="actions__item"><a class="actions__link" href="https://jira.d2iq.com/secure/CreateIssueDetails!init.jspa?pid=14105&amp;issuetype=1&amp;summary=Feedback+for+Operations&amp;description=Source:%20https://docs.d2iq.com/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations&amp;labels=documentation&amp;labels=needs_triage&amp;components=19804&amp;priority=3&amp;customfield_12300=44" target="_blank"><i class="actions__icon" data-feather="message-square"></i><span class="actions__text">Feedback</span></a></li></ul></div></div><article class="content__article"><p>The DC/OS Percona XtraDB Cluster service provides a robust API (accessible by HTTP or DC/OS CLI) for managing, repairing, and monitoring the service. Here, only the CLI version is presented for conciseness, but see the <a href="#api-reference">API Reference</a> for HTTP instructions.</p>
<h2 id="plan-operations"><a class="content__anchor" href="#plan-operations" aria-hidden="true"><i data-feather="bookmark"></i></a>Plan Operations</h2>
<p>An instance of the DC/OS Percona XtraDB Cluster service is ultimately a set of plans (how to run the service) and a set of pods (what to run). The service is driven primarily by two plans, <code>deploy</code> and <code>recovery</code>.</p>
<p>The <code>deploy</code> plan is used during initial installation, as well as during configuration and service updates. The <code>recovery</code> plan is an always-running plan that ensures that the pods and tasks that should be running, stay running. Other plans (“sidecars”) are used for secondary operations.</p>
<p>Every plan is made up of a set of phases, each of which consists of one or more steps.</p>
<h3 id="listing-plans"><a class="content__anchor" href="#listing-plans" aria-hidden="true"><i data-feather="bookmark"></i></a>Listing plans</h3>
<p>A list of plans can be retrieved using the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan list

</code></pre>
<h3 id="inspecting-a-plan"><a class="content__anchor" href="#inspecting-a-plan" aria-hidden="true"><i data-feather="bookmark"></i></a>Inspecting a plan</h3>
<p>View the current status of a plan using the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan status &lt;plan-name&gt;
</code></pre>
<p>For example, the status of the completed deploy plan of the service will be:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan status deploy
dcos percona-pxc-mysql --name&amp;#x3D;percona-pxc-mysql plan status deploy
  ├─ proxysql (serial strategy) (COMPLETE)
  │  └─ proxysql-0:[psql] (COMPLETE)
  ├─ node (serial strategy) (COMPLETE)
  │  ─ pxc-0:[init] (COMPLETE)
  │  ├─ pxc-0:[node] (COMPLETE)
  │  ├─ pxc-1:[node] (COMPLETE)
  │  └─ pxc-2:[node] (COMPLETE)
  ├─ mysqldexporter (serial strategy) (COMPLETE)
  │  └─ mysqldexporter-0:[exporterstart] (COMPLETE)
    └─ psqlconf (serial strategy) (COMPLETE)
    └─ psqlconf-0:[mysqlcli] (COMPLETE)

</code></pre>
<p class="message--note"><strong>NOTE: </strong>Passing the <tt>--json</tt> flag to the <tt>status</tt> command will return a JSON response which has UUIDs for the phases and steps of a plan. These UUIDs can be useful in the other plan commands.</p>
<h3 id="operating-on-a-plan"><a class="content__anchor" href="#operating-on-a-plan" aria-hidden="true"><i data-feather="bookmark"></i></a>Operating on a plan</h3>
<h4 id="start"><a class="content__anchor" href="#start" aria-hidden="true"><i data-feather="bookmark"></i></a>Start</h4>
<p>Start a plan with the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan start &lt;plan-name&gt;
</code></pre>
<h4 id="pause"><a class="content__anchor" href="#pause" aria-hidden="true"><i data-feather="bookmark"></i></a>Pause</h4>
<p>Pauses the plan, or a specific phase in that plan with the provided phase name (or UUID).</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan pause &lt;plan (required)&gt; &lt;phase (optional)&gt;
</code></pre>
<h4 id="stop"><a class="content__anchor" href="#stop" aria-hidden="true"><i data-feather="bookmark"></i></a>Stop</h4>
<p>Stops the running plan with the provided name.</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan stop &lt;plan&gt;
</code></pre>
<p>Plan Stop differs from Plan Pause in the following ways:</p>
<ul>
<li>Pause can be issued for a specific phase or for all phases within a plan. Stop can only be issued for a plan.</li>
<li>Pause updates the underlying Phase/Step state. Stop both ceases execution and of the plan and resets the plan to its initial pending state.</li>
</ul>
<h4 id="resume"><a class="content__anchor" href="#resume" aria-hidden="true"><i data-feather="bookmark"></i></a>Resume</h4>
<p>Resumes the plan, or a specific phase in that plan, with the provided phase name (or UUID).</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql plan resume &lt;plan (required)&gt; &lt;phase (optional)&gt;
</code></pre>
<h4 id="force-restart"><a class="content__anchor" href="#force-restart" aria-hidden="true"><i data-feather="bookmark"></i></a>Force-Restart</h4>
<p>Restarts the specified step, phase if no step is specified, or plan if no phase is specified.</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql force-restart &lt;plan (required)&gt; &lt;phase (optional)&gt; &lt;step (optional)&gt;
</code></pre>
<h4 id="force-complete"><a class="content__anchor" href="#force-complete" aria-hidden="true"><i data-feather="bookmark"></i></a>Force-Complete</h4>
<p>Force completes a specific step in the provided phase of the plan. From the CLI it is only possible to force complete a step. The HTTP API supports force completing on phases and plans in their entirety.</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql force-complete &lt;plan (required)&gt; &lt;phase (required)&gt; &lt;step (required)&gt;
</code></pre>
<h2 id="pod-operations"><a class="content__anchor" href="#pod-operations" aria-hidden="true"><i data-feather="bookmark"></i></a>Pod Operations</h2>
<p>A deployed instance of the DC/OS Percona XtraDB Cluster service is made up of a set of running pods. Using the pod API, it is possible to manage the lifecycle of these pods as well as investigate failures of the pods and their tasks.</p>
<p class="message--note"><strong>NOTE: </strong>Managing pod count is done via the service configuration and does not have a direct API.</p>
<h3 id="list"><a class="content__anchor" href="#list" aria-hidden="true"><i data-feather="bookmark"></i></a>List</h3>
<p>To list all the pods of the service run the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql pod list
</code></pre>
<h3 id="status"><a class="content__anchor" href="#status" aria-hidden="true"><i data-feather="bookmark"></i></a>Status</h3>
<p>To view the status of all pods or optionally just one pod run the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql pod status &lt;pod-name (optional)&gt;
</code></pre>
<p>This will show any status overrides for pods and their tasks.</p>
<h3 id="restart"><a class="content__anchor" href="#restart" aria-hidden="true"><i data-feather="bookmark"></i></a>Restart</h3>
<p>To restart a pod in place, use the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql pod restart &lt;pod-name&gt;
</code></pre>
<p>This will kill the tasks of the pod, and relaunch them in-place. The progress of the restart can be monitored by watching the <code>recovery</code> plan of the service.</p>
<h3 id="replace"><a class="content__anchor" href="#replace" aria-hidden="true"><i data-feather="bookmark"></i></a>Replace</h3>
<p>Replace should be used <strong>only</strong> when the current instance of the pod should be completely destroyed. All persistent data (read: volumes) of the pod will be destroyed. Replace should be used when a DC/OS agent is being removed, is permanently down, or pod placement constraints need to be updated.</p>
<p>Issue a replace by running the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql pod replace &lt;pod-name&gt;
</code></pre>
<h3 id="pause-2"><a class="content__anchor" href="#pause-2" aria-hidden="true"><i data-feather="bookmark"></i></a>Pause</h3>
<p>Pausing a pod relaunches it in an idle command state. This allows you to debug the contents of the pod, possibly making changes to fix problems, while still having access to all the context of the pod (such as volumes)</p>
<p>Using pause and <code>dcos task exec</code> is a very powerful debugging tool. To pause a pod use the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql debug pod pause &lt;pod-name&gt;
</code></pre>
<p>To pause a specific task of a pod append the <code>-t &lt;task-name&gt;</code> flag,</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql debug pod pause &lt;pod-name&gt; -t &lt;task-name&gt;
</code></pre>
<p>Use the <code>pod status</code> command to check what tasks and pods are in an overridden state.</p>
<h3 id="resume-2"><a class="content__anchor" href="#resume-2" aria-hidden="true"><i data-feather="bookmark"></i></a>Resume</h3>
<p>To resume a paused pod or task use the CLI command:</p>
<pre><code class="language-bash">dcos percona-pxc-mysql --name=percona-pxc-mysql debug pod resume &lt;pod-name&gt; [-t &lt;task-name&gt;]
</code></pre>
<p>Check the <code>pod status</code> command to verify that the pod (or task) has properly resumed.</p>
<h2 id="service-metrics"><a class="content__anchor" href="#service-metrics" aria-hidden="true"><i data-feather="bookmark"></i></a>Service Metrics</h2>
<p>The DC/OS Percona XtraDB Cluster service pushes metrics into the DC/OS metrics system. Details on consuming them can be found at the documentation on the <a href="/dcosdocs/mesosphere/dcos/latest/metrics/">DC/OS metrics system</a>.</p>
<h2 id="logging"><a class="content__anchor" href="#logging" aria-hidden="true"><i data-feather="bookmark"></i></a>Logging</h2>
<p>DC/OS has three ways to access service scheduler and service task logs.</p>
<ol>
<li>Via the DC/OS GUI</li>
<li>Via the Mesos GUI</li>
<li>Via the DC/OS CLI</li>
</ol>
<h3 id="dcos-gui"><a class="content__anchor" href="#dcos-gui" aria-hidden="true"><i data-feather="bookmark"></i></a>DC/OS GUI</h3>
<p>A service’s logs are accessed by selecting the service in the <strong>Services</strong> tab. Both the service scheduler and service tasks are displayed side by side in this view. To view the tasks sandbox (files) as well as its <code>stdout</code> and <code>stderr</code>, click on a task.</p>
<h3 id="mesos-gui"><a class="content__anchor" href="#mesos-gui" aria-hidden="true"><i data-feather="bookmark"></i></a>Mesos GUI</h3>
<p>The Mesos GUI provides similar access as that of the DC/OS UI, but the service scheduler is separate from the service tasks. The service tasks can all be found in the <strong>Frameworks</strong> tab under the framework with the same name as the service. The service scheduler can be found in the Marathon framework, it will be a task with the same name as the service.</p>
<p>Access both the files and logs of a service by clicking on its <code>sandbox</code> link.</p>
<p><a href="/dcosdocs/mesosphere/dcos/services/img/ops-guide-scheduler-sandbox.png"><img src="/dcosdocs/mesosphere/dcos/services/img/ops-guide-scheduler-sandbox.png" alt="contents of a scheduler sandbox" width="400"/></a></p>
<p>Figure 1 - Scheduler sandbox</p>
<h3 id="dcos-cli"><a class="content__anchor" href="#dcos-cli" aria-hidden="true"><i data-feather="bookmark"></i></a>DC/OS CLI</h3>
<p>The <code>dcos task log</code> subcommand allows you to pull logs from multiple tasks at the same time. The <code>dcos task log &lt;task-pattern&gt;</code> command will fetch logs for all tasks matching the prefix pattern. See the help of the subcommand for full details of the command.</p>
<h3 id="mesos-agent-logs"><a class="content__anchor" href="#mesos-agent-logs" aria-hidden="true"><i data-feather="bookmark"></i></a>Mesos Agent logs</h3>
<p>Occasionally, it can also be useful to examine what a given Mesos agent is doing. The Mesos Agent handles deployment of Mesos tasks to a given physical system in the cluster. One Mesos Agent runs on each system. These logs can be useful for determining if there is a problem at the system level that is causing alerts across multiple services on that system.</p>
<p>Mesos agent logs can be accessed via the Mesos GUI or directly on the agent. The GUI method is described here.</p>
<p>Navigate to the agent you want to view either directly from a task by clicking the “Agent” item in the breadcrumb when viewing a task (this will go directly to the agent hosting the task), or by navigating through the “Agents” menu item at the top of the screen (you will need to select the desired agent from the list).</p>
<p>In the Agent view, you will see a list of frameworks with a presence on that Agent. In the left pane you will see a plain link named “LOG”. Click that link to view the agent logs.</p>
<p><a href="/dcosdocs/mesosphere/dcos/services/img/ops-guide-agent.png"><img src="/dcosdocs/mesosphere/dcos/services/img/ops-guide-agent.png" alt="view of tasks running on a given agent" width="400"/></a></p>
<p>Figure 2 - List of frameworks</p>
<h1 id="external-client-access-proxysql-and-edge-lb-configuration"><a class="content__anchor" href="#external-client-access-proxysql-and-edge-lb-configuration" aria-hidden="true"><i data-feather="bookmark"></i></a>External Client Access (ProxySQL and Edge-LB configuration)</h1>
<h2 id="configuring-proxysql"><a class="content__anchor" href="#configuring-proxysql" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuring ProxySQL</h2>
<p>ProxySQL is auto configured by the service with these defaults:</p>
<ul>
<li>Refresh Interval: 2000</li>
<li>Threads: 2</li>
<li>Max Connections: 2048</li>
<li>Default Query Timeout: 10000</li>
<li>Poll Timeout: 2000</li>
<li>Default Schema: information_schema</li>
<li>Stacksize: 1048576</li>
<li>Connect Timeout Server: 10000</li>
<li>Monitor History: 60000</li>
<li>Monitor Connect Interval: 20000</li>
<li>Monitor Ping Interval: 10000</li>
<li>Ping Timeout Server: 200</li>
<li>Commands Stats: True</li>
<li>Sessions Sort: True</li>
</ul>
<h2 id="configuring-edge-lb"><a class="content__anchor" href="#configuring-edge-lb" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuring Edge-LB</h2>
<ol>
<li>
<p>Install Edge-LB using the following steps:</p>
<pre><code class="language-shell">dcos package repo add --index=0 edgelb-aws \
https://edge-lb-infinity-artifacts.s3.amazonaws.com/autodelete7d/master/edgelb/stub-universe-edgelb.json
</code></pre>
<pre><code>dcos package repo add --index=0 edgelb-pool-aws \
https://edge-lb-infinity-artifacts.s3.amazonaws.com/autodelete7d/master/edgelb-pool/stub-universe-edgelb-pool.json
</code></pre>
<pre><code>dcos package install edgelb --yes
</code></pre>
<pre><code>dcos package install edgelb --cli
</code></pre>
<pre><code>dcos edgelb create pxc-edgelb.json
</code></pre>
</li>
<li>
<p>In the <code>pxc-edgelb.json</code> file, update the <code>proxysql-client-endpoint</code> accordingly:</p>
</li>
</ol>
<pre><code class="language-json">{       
  &quot;apiVersion&quot;: &quot;V2&quot;,
  &quot;name&quot;: &quot;pxc&quot;,
  &quot;count&quot;: 1,
  &quot;haproxy&quot;: {
    &quot;frontends&quot;: [{
      &quot;bindPort&quot;: 3306,
      &quot;protocol&quot;: &quot;TCP&quot;,
      &quot;linkBackend&quot;: {
        &quot;defaultBackend&quot;: &quot;pxc&quot;
      }
    }],
    &quot;backends&quot;: [{
      &quot;name&quot;: &quot;pxc&quot;,
      &quot;protocol&quot;: &quot;TCP&quot;,
      &quot;services&quot;: [{
        &quot;endpoint&quot;: {
          &quot;type&quot;: &quot;ADDRESS&quot;,
          &quot;address&quot;: &quot;&lt;proxysql-client-endpoint&gt;&quot;,
          &quot;port&quot;: 3306
        }
      }]
    }]
  }
}
</code></pre>
<ol>
<li>
<p>Run the following command from any host machine running Docker:</p>
<pre><code class="language-shell">docker run --name mysql-cli -e MYSQL_ROOT_PASSWORD=root -d mysql:5.7
</code></pre>
</li>
<li>
<p>Get into the container by running a bash into this as follows:</p>
<pre><code class="language-shell">sudo docker exec -ti mysql-cli bash
</code></pre>
</li>
<li>
<p>Note down the public slave security group IP address for the DC/OS cluster on which DC/OS is running. Use this IP address in the following command:</p>
<pre><code class="language-shell">mysql -u&lt;application_user_name&gt; -p&lt;application_user_passwd&gt; -h&lt;public_slave_securitygrpIP&gt; -P3306
</code></pre>
<p>This will connect to your Percona XtraDB Cluster cluster.</p>
</li>
</ol>
<p>Now you may start using the cluster by creating a database and tables on it.</p>
<div class="grid"><a class="grid__item" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/install"><div class="grid__header__wrapper"><h3 class="grid__header">Install</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">Installation guide, best practices and constraints<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/security"><div class="grid__header__wrapper"><h3 class="grid__header">Security</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">Encryption, authentication, and authorization mechanisms<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/disaster-recovery"><div class="grid__header__wrapper"><h3 class="grid__header">Disaster Recovery</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">Back up and restore your data<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/troubleshooting"><div class="grid__header__wrapper"><h3 class="grid__header">Troubleshooting</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">Troubleshooting Percona XtraDB Cluster<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/services/pxc/0.2.1-5.7.21/operations/uninstall"><div class="grid__header__wrapper"><h3 class="grid__header">Uninstalling</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">Uninstalling DC/OS Percona XtraDB Cluster Service<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a></div></article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h2"><a href="#plan-operations">Plan Operations</a></li><li class="content__sections-item content__sections-item--h2"><a href="#pod-operations">Pod Operations</a></li><li class="content__sections-item content__sections-item--h2"><a href="#service-metrics">Service Metrics</a></li><li class="content__sections-item content__sections-item--h2"><a href="#logging">Logging</a></li><li class="content__sections-item content__sections-item--h1"><a href="#external-client-access-proxysql-and-edge-lb-configuration">External Client Access (ProxySQL and Edge-LB configuration)</a></li><li class="content__sections-item content__sections-item--h2"><a href="#configuring-proxysql">Configuring ProxySQL</a></li><li class="content__sections-item content__sections-item--h2"><a href="#configuring-edge-lb">Configuring Edge-LB</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>