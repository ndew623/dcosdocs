<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Securing a cluster - D2iQ Docs</title><meta name="description" content="Understanding the security features in DC/OS"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/dcosdocs/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/2.1/administering-clusters/securing-your-cluster">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 2.1"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/2.2/administering-clusters/securing-your-cluster">Mesosphere DC/OS 2.2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/securing-your-cluster">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.0/administering-clusters/securing-your-cluster">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/1.13/administering-clusters/securing-your-cluster">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 2.1</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/overview/"><i data-feather="chevron-right"></i>Overview</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/installing/"><i data-feather="chevron-right"></i>Installing</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li class="active"><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/sshcluster/">SSHing into Nodes</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/locate-public-agent/">Finding a Public Agent IP</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/multiple-clusters/"><i data-feather="chevron-right"></i>Multiple Clusters</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/component-management/">Component Management</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/backup-and-restore/"><i data-feather="chevron-right"></i>Backup and Restore</a></li><li class="active active-on"><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/securing-your-cluster/">Securing a cluster</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/managing-aws/">Managing AWS</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/package-registry/">Package Registry</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/convert-agent-type/">Converting Agent Node Types</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/add-a-node/">Adding Agent Nodes</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/replacing-a-master-node/">Replace a master node</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/draining-a-node/">Draining a Node</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/delete-node/">Shut Down and Decommission Nodes</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/recovering-agent-disk-space/">Recovering Agent Disk Space</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/licenses/"><i data-feather="chevron-right"></i>Licenses</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/multi-tenancy/"><i data-feather="chevron-right"></i>Multi-Tenancy for DC/OS Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Securing a cluster</h1></div><h4 class="content__header-description">Understanding the security features in DC/OS</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/2.1/administering-clusters/securing-your-cluster/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><h1 id="general-security-concepts"><a class="content__anchor" href="#general-security-concepts" aria-hidden="true"><i data-feather="bookmark"></i></a>General security concepts</h1>
<p>DC/OS is based on a Linux kernel and user space. The same best practices for
securing any Linux system apply to securing DC/OS, including setting correct
file permissions, restricting root and normal user accounts, protecting
network interfaces with <code>iptables</code> or other firewalls, and regularly applying
updates from the Linux distribution used with DC/OS to ensure that system
libraries, utilities and core services like systemd and OpenSSH are secure.</p>
<h1 id="network-security"><a class="content__anchor" href="#network-security" aria-hidden="true"><i data-feather="bookmark"></i></a>Network security</h1>
<p>You must use appropriate network mechanisms to prevent unauthorized access to cluster nodes.</p>
<p>Depending on your cluster environment, this may include:</p>
<ul>
<li>using physical or virtual subnets to isolate <a href="#security-zones">DC/OS Security Zones</a>;</li>
<li>using router firewalls or security groups to restrict access to ports;</li>
<li>using firewall software (for example, <code>iptables</code>) on the nodes to restrict access to ports.</li>
</ul>
<p>Use these mechanisms to provide the following connectivity:</p>
<ul>
<li>between master nodes: allow connections on all ports.</li>
<li>between agent nodes: allow connections on all ports.</li>
<li>from master nodes to agent nodes: allow connections on all ports.</li>
<li>from agent nodes to master nodes: allow connections on all ports except TCP ports 8201 and 26257.</li>
<li>from external machines to master nodes: block connection requests on all ports except TCP ports 80 and 443.</li>
<li>from external machines to private agent nodes: block connection requests on all ports.</li>
<li>from external machines to public agent nodes: block connection requests on all ports except <a href="/dcosdocs/mesosphere/dcos/2.1/installing/production/system-requirements/ports/#agent">advertised port ranges</a>.</li>
</ul>
<p>You may want to open port 22 to external machines to allow administrative tasks using Secure Shell (<code>ssh</code>).
Although DC/OS components do not currently support private network selection, you can configure
<code>ssh</code> to be accessible to a private management network using the <a href="https://man.openbsd.org/sshd_config#ListenAddress"><code>ListenAddress</code></a> directive.</p>
<h1 id="security-zones"><a class="content__anchor" href="#security-zones" aria-hidden="true"><i data-feather="bookmark"></i></a>Security zones</h1>
<p>At the highest level we can distinguish three security zones in a DC/OS
deployment, namely the admin, private, and public security zones.</p>
<h2 id="admin-zone"><a class="content__anchor" href="#admin-zone" aria-hidden="true"><i data-feather="bookmark"></i></a>Admin zone</h2>
<p>The <strong>admin</strong> zone is accessible via HTTP/HTTPS and SSH connections, and
provides access to the master nodes. It also provides reverse proxy access to
the other nodes in the cluster via URL routing. For security, the DC/OS cloud
template allows configuring a whitelist so that only specific IP address
ranges are permitted to access the admin zone.</p>
<h3 id="admin-router"><a class="content__anchor" href="#admin-router" aria-hidden="true"><i data-feather="bookmark"></i></a>Admin Router</h3>
<p>Access to the admin zone is controlled by Admin Router.</p>
<p>HTTP requests incoming to your DC/OS cluster are proxied through Admin Router (using <a href="http://nginx.org">Nginx</a> with <a href="https://openresty.org">OpenResty</a> at its core). Admin Router denies access to most HTTP endpoints for unauthenticated requests. In order for a request to be authenticated, it must present a valid authentication token in its Authorization header. A token can be obtained by going through the authentication process. See the <a href="/dcosdocs/mesosphere/dcos/2.1/security/">Security documentation</a> for more information.</p>
<p>Authenticated users are authorized to perform any actions in their cluster. There is currently no fine-grained access control in DC/OS besides having access or not having access to services.</p>
<h4 id="steps-for-securing-admin-router"><a class="content__anchor" href="#steps-for-securing-admin-router" aria-hidden="true"><i data-feather="bookmark"></i></a>Steps for securing Admin Router</h4>
<p>By default, Admin Router will permit unencrypted HTTP traffic. This is not considered secure, and you must provide a valid TLS certificate and redirect all HTTP traffic to HTTPS to properly secure access to your cluster. After you have a valid TLS certificate, install the certificate on each master. Copy the certificate and private key to a well known location, such as under <code>/etc/ssl/certs</code>.</p>
<p>If you run HAProxy in front of Admin Router, you should secure the communication between them. For information about securing your communication, see the <a href="/dcosdocs/mesosphere/dcos/2.1/security/ent/tls-ssl/haproxy-adminrouter/">documentation</a>.</p>
<h2 id="private-zone"><a class="content__anchor" href="#private-zone" aria-hidden="true"><i data-feather="bookmark"></i></a>Private zone</h2>
<p>A <strong>private</strong> zone is a non-routable network that is only accessible from
the admin zone or through the edge router from the public zone. Deployed
services are run in the private zone. This zone is where the majority of agent
nodes are run.</p>
<h2 id="public-zone"><a class="content__anchor" href="#public-zone" aria-hidden="true"><i data-feather="bookmark"></i></a>Public zone</h2>
<p>The optional <strong>public</strong> zone is where publicly accessible applications are run. Generally, only a small number of agent nodes are run in this zone. The edge router forwards traffic to applications running in the private zone.</p>
<p>The agent nodes in the public zone are labeled with a special role so that only specific tasks can be scheduled here. These agent nodes have both public and private IP addresses and only specific ports should be open in their
<code>iptables</code> firewall.</p>
<p>By default, when using the cloud-based installers such as the AWS CloudFormation templates, a large number of ports are exposed to the Internet for the public zone. In production systems, it is unlikely that you would expose all of these ports. It is recommended that you close all ports except 80 and 443 (for HTTP/HTTPS traffic) and use <a href="/dcosdocs/mesosphere/dcos/services/marathon-lb/latest/">Marathon-LB</a> with HTTPS to manage ingress traffic.</p>
<h3 id="typical-aws-deployment"><a class="content__anchor" href="#typical-aws-deployment" aria-hidden="true"><i data-feather="bookmark"></i></a>Typical AWS deployment</h3>
<p>A typical AWS deployment including AWS Load Balancers is shown below:</p>
<p><img src="/dcosdocs/mesosphere/dcos/2.1/img/security-zones.jpg" alt="Security Zones"></p>
<p>Figure 1. Security zones in AWS deployment</p>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#general-security-concepts">General security concepts</a></li><li class="content__sections-item content__sections-item--h1"><a href="#network-security">Network security</a></li><li class="content__sections-item content__sections-item--h1"><a href="#security-zones">Security zones</a></li><li class="content__sections-item content__sections-item--h2"><a href="#admin-zone">Admin zone</a></li><li class="content__sections-item content__sections-item--h2"><a href="#private-zone">Private zone</a></li><li class="content__sections-item content__sections-item--h2"><a href="#public-zone">Public zone</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>