<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Security - D2iQ Docs</title><meta name="description" content="DC/OS NiFi Service encryption, authentication, and authorization"><link rel="apple-touch-icon" sizes="180x180" href="/dcosdocs/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/dcosdocs/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/dcosdocs/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/dcosdocs/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/dcosdocs/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>Nifi Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/services">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS Services"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/security">NiFi 1.0.1-1.9.2</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.0-1.9.2/security">NiFi 1.0.0-1.9.2</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.5.0-1.9.2/security">NiFi 0.5.0-1.9.2</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.4.1-1.8.0/security">NiFi 0.4.1-1.8.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.4.0-1.8.0/security">NiFi 0.4.0-1.8.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.3.0-1.7.1/security">NiFi 0.3.0-1.7.1</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.2.0-1.5.0/security">NiFi 0.2.0-1.5.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/nifi/0.1.0-1.5.0/security">NiFi 0.1.0-1.5.0</a></li></ul><div class="toggle"><p><span class="title">Nifi</span><span class="version"> 1.0.1-1.9.2</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/release-notes/">Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/getting-started/">Getting Started</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/configuration/">Configuration</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/deploy-best-practice/">Deployment Best Practices</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/managing/">Operations</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/offload-node/">Offload Node</a></li><li class="active active-on"><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/security/">Security</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/uninstall/">Uninstall</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/connecting-clients/">Connecting Clients</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/troubleshooting/">Troubleshooting</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/advanced/">Advanced</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/api-reference/">API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/limitations/">Limitations</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/support-policy/">Support Policy</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Security</h1></div><h4 class="content__header-description">DC/OS NiFi Service encryption, authentication, and authorization</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/services/nifi/1.0.1-1.9.2/security/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><h1 id="dcos-nifi-security"><a class="content__anchor" href="#dcos-nifi-security" aria-hidden="true"><i data-feather="bookmark"></i></a>DC/OS NiFi Security</h1>
<p>The DC/OS NiFi service supports DC/OS NiFi’s native transport encryption, authentication, and authorization mechanisms. The service provides automation and orchestration to simplify the usage of these important features.</p>
<h2 id="transport-encryption-and-kerberos-authentication"><a class="content__anchor" href="#transport-encryption-and-kerberos-authentication" aria-hidden="true"><i data-feather="bookmark"></i></a>Transport Encryption and Kerberos Authentication</h2>
<p>With transport encryption enabled, DC/OS NiFi will automatically deploy all nodes with the correct configuration to encrypt communication via SSL. The nodes will communicate securely between themselves using SSL. SSL authentication requires that all DC/OS NiFi Nodes present a valid certificate from which their identity can be derived for communicating between themselves.
DC/OS NiFi uses the CN of the SSL certificate as the principal for a given Node.
For example, CN=nifi-0-node.demonifi, O=“Mesosphere, Inc”, L=San Francisco, ST=CA, C=US.</p>
<p>The service uses the <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/tls-ssl/">DC/OS CA</a> to generate the SSL artifacts that it uses to secure the service. Any client that trusts the DC/OS CA will consider the service’s certificates valid.</p>
<p class="message--note"><strong>NOTE: </strong>Enabling transport encryption is required to use <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/tls-ssl/">SSL authentication</a> for authentication, but is optional for Kerberos authentication.</p>
<h2 id="prerequisites"><a class="content__anchor" href="#prerequisites" aria-hidden="true"><i data-feather="bookmark"></i></a>Prerequisites</h2>
<ul>
<li>A DC/OS Service Account with a secret stored in the <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/service-auth/custom-service-auth/">DC/OS Secret Store.</a></li>
<li>DC/OS superuser permissions for modifying the permissions of the Service Account.</li>
</ul>
<h2 id="configure-transport-encryption"><a class="content__anchor" href="#configure-transport-encryption" aria-hidden="true"><i data-feather="bookmark"></i></a>Configure Transport Encryption</h2>
<p class="message--note"><strong>NOTE: </strong>A complete guide to Configuring DC/OS Access for DC/OS NiFi can be found <a href="/dcosdocs/mesosphere/dcos/services/nifi/configure-dcos-access/">here.</p>
<h2 id="set-up-the-service-account"><a class="content__anchor" href="#set-up-the-service-account" aria-hidden="true"><i data-feather="bookmark"></i></a>Set up the service account</h2>
<p><a href="/dcosdocs/mesosphere/dcos/latest/security/ent/perms-management/">Grant</a> the service account the correct permissions. The required permissions are:</p>
<pre><code class="language-shell">dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:agent:task:user:${USER} create
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:task:user:${USER} create
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:framework:role:${FOLDER_ROLE} create
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:reservation:principal:${SERVICE_ACCOUNT} delete
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:reservation:role:${FOLDER_ROLE} create
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:volume:principal:${SERVICE_ACCOUNT} delete
dcos security org users grant ${SERVICE_ACCOUNT} dcos:mesos:master:volume:role:${FOLDER_ROLE} create
dcos security org users grant ${SERVICE_ACCOUNT} dcos:secrets:default:/&lt;service name&gt;/* full
dcos security org users grant ${SERVICE_ACCOUNT} dcos:secrets:list:default:/&lt;service name&gt; read
dcos security org users grant ${SERVICE_ACCOUNT} dcos:adminrouter:ops:ca:rw full
dcos security org users grant ${SERVICE_ACCOUNT} dcos:adminrouter:ops:ca:ro full
</code></pre>
<ul>
<li>In DC/OS before 2.0 <code>FOLDER_ROLE</code> is path for service with slashes replaced by double undescores e.g. <code>fully__qualified__path__{$SERVICE_NAME}-role</code>.</li>
<li>In DC/OS 2.0 and later <code>FOLDER_ROLE</code> is the name of the top-level group where the service is located.</li>
</ul>
<h4 id="transport-encryption-for-clients"><a class="content__anchor" href="#transport-encryption-for-clients" aria-hidden="true"><i data-feather="bookmark"></i></a>Transport Encryption for Clients</h4>
<p>With Transport Encryption enabled, service clients will need to be configured to use the <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/tls-ssl/get-cert/">DC/OS CA bundle</a> to verify the connections they make to the service. Consult your client’s documentation for trusting a CA and configure your client appropriately.</p>
<h2 id="authentication"><a class="content__anchor" href="#authentication" aria-hidden="true"><i data-feather="bookmark"></i></a>Authentication</h2>
<p>DC/OS NiFi supports two authentication mechanisms, SSL and Kerberos. The two are supported independently and may not be combined. If both SSL and Kerberos authentication are enabled, the service will use Kerberos authentication.</p>
<p class="message--note"><strong>NOTE: </strong>Kerberos authentication can, however, be combined with transport encryption.</p>
<h2 id="ca-based-authentication-between-nodes"><a class="content__anchor" href="#ca-based-authentication-between-nodes" aria-hidden="true"><i data-feather="bookmark"></i></a>CA based authentication between nodes</h2>
<p>DC/OS NiFi requires certificate based authentication between nodes.
DC/OS NiFi uses the CN of the SSL certificate as the principal for a given Node.
For example, CN=nifi-0-node.demonifi, O=“Mesosphere, Inc”, L=San Francisco, ST=CA, C=US.</p>
<h2 id="kerberos-authentication-for-end-users"><a class="content__anchor" href="#kerberos-authentication-for-end-users" aria-hidden="true"><i data-feather="bookmark"></i></a>Kerberos Authentication for End Users</h2>
<p>Kerberos authentication relies on a central authority to verify that DC/OS NiFi clients are who they say they are. DC/OS NiFi integrates with your existing Kerberos infrastructure to verify the identity of clients.</p>
<h3 id="prerequisites-2"><a class="content__anchor" href="#prerequisites-2" aria-hidden="true"><i data-feather="bookmark"></i></a>Prerequisites</h3>
<ul>
<li>The hostname and port of a Key Distribution Center (KDC) reachable from your DC/OS cluster</li>
<li>Sufficient access to the KDC to create Kerberos principals</li>
<li>Sufficient access to the KDC to retrieve a keytab for the generated principals</li>
<li><a href="/dcosdocs/mesosphere/dcos/latest/cli/enterprise-cli/#installing-the-dcos-enterprise-cli">The DC/OS Enterprise CLI</a></li>
<li>DC/OS Superuser permissions</li>
</ul>
<h3 id="configure-kerberos-authentication"><a class="content__anchor" href="#configure-kerberos-authentication" aria-hidden="true"><i data-feather="bookmark"></i></a>Configure Kerberos Authentication</h3>
<ol>
<li>
<p>Create principals. The DC/OS NiFi service requires a Kerberos principal for the service principal and user principal. Each principal must be of the form:</p>
<pre><code class="language-shell">nifiprincipal@&lt;service realm&gt;
nifiadmin@&lt;service realm&gt;
</code></pre>
</li>
<li>
<p>Place Service Keytab in DC/OS Secret Store. The DC/OS NiFi service uses a keytab containing the above service and user principals (service keytab). After creating the principals above, generate the service keytab, making sure to include all the node principals. The DC/OS security modules will handle decoding the file when it is used by the service.</p>
<p>Create secret named <code>nifiadmin_kerberos_secret</code> for password of Kerberos User Principal: <code>nifiadmin</code></p>
 <p class="message--note"><strong>NOTE: </strong>Secrets access is controlled by <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/#spaces-for-secrets">DC/OS Spaces</a>, which function like namespaces. Any secret in the same DC/OS Space as the service will be accessible by the service.</p>
</li>
<li>
<p>Install the DC/OS NiFi service with the following options in addition to your own:</p>
<pre><code class="language-json">{
 &quot;service&quot;: {
  &quot;name&quot;: &quot;/demo/nifi&quot;,
   &quot;security&quot;: {
   &quot;kerberos&quot;: {
     &quot;kdc&quot;: {
       &quot;hostname&quot;: &quot;kdc.marathon.autoip.dcos.thisdcos.directory&quot;,
       &quot;port&quot;: 2500
     },
     &quot;keytab_secret&quot;: &quot;&lt;keytab secret&gt;&quot;,
     &quot;primary&quot;: &quot;nifi&quot;,
     &quot;realm&quot;: &quot;LOCAL&quot;,
     &quot;service_principal&quot;: &quot;nifiprincipal@LOCAL&quot;,
     &quot;user_principal&quot;: &quot;nifiadmin@LOCAL&quot;,
     &quot;user_principal_keytab&quot;: &quot;nifiadmin_kerberos_secret&quot;
   },
   &quot;kerberos_tls&quot;: {
     &quot;enable&quot;: true
   }
 },
 &quot;service_account&quot;: &quot;dcos_nifi&quot;,
 &quot;service_account_secret&quot;: &quot;dcos_nifi_secret&quot;,
 &quot;virtual_network_enabled&quot;: true,
 &quot;virtual_network_name&quot;: &quot;dcos&quot;
 },
 &quot;secrets&quot;: {&quot;enable&quot;: true}
 }
</code></pre>
</li>
</ol>
<h1 id="configuring-dcos-access-for-dcos-nifi"><a class="content__anchor" href="#configuring-dcos-access-for-dcos-nifi" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuring DC/OS Access for DC/OS NiFi</h1>
<h1 id="provisioning-a-service-account"><a class="content__anchor" href="#provisioning-a-service-account" aria-hidden="true"><i data-feather="bookmark"></i></a><a name="provision-a-service-account"></a>Provisioning a service account</h1>
<p>This section describes how to configure DC/OS access for NiFi. Depending on your <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/#security-modes/">security mode</a>, NiFi may require <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/service-auth/">service authentication</a> for access to DC/OS.</p>
<p>A service like NiFi typically performs certain privileged actions on the cluster, which might require authenticating with the cluster. A service account associated with the service is used to authenticate with the DC/OS cluster. It is recommended to provisioning a separate service account for each service that would perform privileged operations. Service accounts authenticate using public-private keypair. The public key is used to create the service account in the cluster, while the corresponding private key is stored in the <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/secrets/">secret store</a>. The service account and the service account secret are passed to the service as install time options.</p>
<table>
<thead>
<tr>
<th>Security mode</th>
<th>Service Account</th>
</tr>
</thead>
<tbody>
<tr>
<td>Disabled</td>
<td>Not available</td>
</tr>
<tr>
<td>Permissive</td>
<td>Optional</td>
</tr>
<tr>
<td>Strict</td>
<td>Required</td>
</tr>
</tbody>
</table>
<p>If you install a service in permissive mode and do not specify a service account, Metronome and Marathon will act as if requests made by this service are made by an account with the <a href="/dcosdocs/mesosphere/dcos/latest/security/ent/perms-reference/#superuser">superuser permission</a>.</p>
<h2 id="prerequisites-3"><a class="content__anchor" href="#prerequisites-3" aria-hidden="true"><i data-feather="bookmark"></i></a>Prerequisites:</h2>
<ul>
<li><a href="/dcosdocs/mesosphere/dcos/latest/cli/install/">DC/OS CLI installed</a> and be logged in as a superuser.</li>
<li><a href="/dcosdocs/mesosphere/dcos/latest/cli/enterprise-cli/#ent-cli-install">Enterprise DC/OS CLI 0.4.14 or later installed</a>.</li>
</ul>
<h1 id="create-a-key-pair"><a class="content__anchor" href="#create-a-key-pair" aria-hidden="true"><i data-feather="bookmark"></i></a><a name="create-a-keypair"></a>Create a Key Pair</h1>
<p>In this step, a 2048-bit RSA public-private key pair is created using the Enterprise DC/OS CLI.</p>
<p>Create a public-private key pair and save each value into a separate file within the current directory.</p>
<pre><code class="language-bash">dcos security org service-accounts keypair &lt;private-key&gt;.pem &lt;public-key&gt;.pem
</code></pre>
<p class="message--note"><strong>NOTE: </strong>You can use the <a href="https://docs.d2iq.com/dcosdocs/mesosphere/dcos/latest/security/ent/secrets/">DC/OS Secret Store</a> to secure the key pair.</p>
<h1 id="create-a-service-account"><a class="content__anchor" href="#create-a-service-account" aria-hidden="true"><i data-feather="bookmark"></i></a><a name="create-a-service-account"></a>Create a Service Account</h1>
<p>From a terminal prompt, create a new service account (for example, <code>nifi</code>) containing the public key (<code>&lt;your-public-key&gt;.pem</code>).</p>
<pre><code class="language-bash">dcos security org service-accounts create -p &lt;your-public-key&gt;.pem -d &lt;description&gt; nifi
</code></pre>
<p>You can verify your new service account using the following command.</p>
<pre><code class="language-bash">dcos security org service-accounts show nifi
</code></pre>
<h1 id="create-a-secret"><a class="content__anchor" href="#create-a-secret" aria-hidden="true"><i data-feather="bookmark"></i></a><a name="create-an-sa-secret"></a>Create a Secret</h1>
<p>Create a secret (<code>nifi/&lt;secret-name&gt;</code>) with your service account and private key specified (<code>&lt;private-key&gt;.pem</code>).</p>
<p class="message--note"><strong>NOTE: </strong>If you store your secret in a path that matches the service name, for example, service name and secret path are both nifi, then only the service named nifi can access it.</p>
<pre><code class="language-bash">dcos security secrets create-sa-secret &lt;private-key&gt;.pem &lt;service-account-id&gt; nifi/&lt;secret-name&gt;
</code></pre>
<p class="message--note"><strong>NOTE: </strong>If you are running, now EOL-ed, DC/OS 1.11 or older you would need to add <tt>--strict</tt> to the above command. For example, <tt>dcos security secrets --strict create-sa-secret <private-key>.pem <service-account-id> nifi/sa-secret</tt> .</p>
<p>You can list the secrets with this command:</p>
<pre><code class="language-bash">dcos security secrets list /
</code></pre>
<h1 id="create-and-assign-permissions"><a class="content__anchor" href="#create-and-assign-permissions" aria-hidden="true"><i data-feather="bookmark"></i></a><a name="give-perms"></a>Create and Assign Permissions</h1>
<p>Use the following DC/OS CLI commands to rapidly provision the NiFi service account with the required permissions.</p>
<ol>
<li>Create the permission.</li>
</ol>
<p class="message--important"><strong>IMPORTANT: </strong>The value to be used for <tt>&lt;service-role&gt;</tt> will be based on the service name, package version and DC/OS version. The table below shows a few examples of service names and the corresponding Mesos roles they would use. This version of nifi is quota support built in. To determine whether the service group, you are deploying a service to, has <tt>enforceRole</tt> set to <tt>true</tt> or <tt>false</tt> please check this <a href="https://support.d2iq.com/s/article/How-to-determine-if-a-top-level-group-is-quota-limited">KB article</a>. </p>
<p>If you need help configuring the permissions for nifi, please feel to reach out to D2iQ support by filing a support ticket. Replace the instances of <tt>&lt;service-role&gt;</tt> with the correct name (<tt>&lt;name&gt;-role</tt>).</p>
<table>
<thead>
<tr>
<th><strong>Service name</strong></th>
<th><strong>&lt;service-role&gt;</strong><br>DC/OS 1.13 or older<br>DC/OS 2.0 or newer AND enforceRole=false</th>
<th><strong>&lt;service-role&gt;</strong><br>DC/OS 2.0 or newer AND enforceRole=true</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/nifi</code></td>
<td><code>nifi-role</code></td>
<td><code>nifi-role</code></td>
</tr>
<tr>
<td><code>/nifi-prod</code></td>
<td><code>nifi-prod-role</code></td>
<td><code>nifi-prod-role</code></td>
</tr>
<tr>
<td><code>/team01/nifi</code></td>
<td><code>team01__nifi-role</code></td>
<td><code>team01</code></td>
</tr>
<tr>
<td><code>/team01/prod/nifi</code></td>
<td><code>team01__prod__nifi-role</code></td>
<td><code>team01</code></td>
</tr>
</tbody>
</table>
<h2 id="permissive"><a class="content__anchor" href="#permissive" aria-hidden="true"><i data-feather="bookmark"></i></a>Permissive</h2>
<p>Run these commands with the service account name you created for the service in the <em>Create a Service Account</em> step above. For example we are using nifi</p>
<pre><code class="language-bash">dcos security org users grant nifi dcos:mesos:master:framework:role:&lt;service-role&gt; create --description &quot;Allow registering as a framework of role &lt;service-role&gt; with Mesos master&quot;
dcos security org users grant nifi dcos:mesos:master:reservation:role:&lt;service-role&gt; create --description &quot;Allow creating Mesos resource reservations of role &lt;service-role&gt;&quot;
dcos security org users grant nifi dcos:mesos:master:volume:role:&lt;service-role&gt; create --description &quot;Allow creating Mesos persistent volumes of role &lt;service-role&gt;&quot;
dcos security org users grant nifi dcos:mesos:master:reservation:principal:nifi delete --description &quot;Allow unreserving Mesos resource reservations with principal nifi&quot;
dcos security org users grant nifi dcos:mesos:master:volume:principal:nifi delete --description &quot;Allow deleting Mesos persistent volumes with principal nifi&quot;
</code></pre>
<h2 id="strict"><a class="content__anchor" href="#strict" aria-hidden="true"><i data-feather="bookmark"></i></a>Strict</h2>
<p>Run these commands with the service account name you created for the service in the <em>Create a Service Account</em> step above. For example we are using nifi</p>
<pre><code class="language-bash">dcos security org users grant nifi dcos:mesos:master:task:user:nobody create --description &quot;Allow running a task as linux user nobody&quot;
dcos security org users grant nifi dcos:mesos:master:framework:role:&lt;service-role&gt; create --description &quot;Allow registering as a framework of role &lt;service-role&gt; with Mesos master&quot;
dcos security org users grant nifi dcos:mesos:master:reservation:role:&lt;service-role&gt; create --description &quot;Allow creating Mesos resource reservations of role &lt;service-role&gt;&quot;
dcos security org users grant nifi dcos:mesos:master:volume:role:&lt;service-role&gt; create --description &quot;Allow creating Mesos persistent volumes of role &lt;service-role&gt;&quot;
dcos security org users grant nifi dcos:mesos:master:reservation:principal:nifi delete --description &quot;Allow unreserving Mesos resource reservations with principal nifi&quot;
dcos security org users grant nifi dcos:mesos:master:volume:principal:nifi delete --description &quot;Allow deleting Mesos persistent volumes with principal nifi&quot;
</code></pre>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#dcos-nifi-security">DC/OS NiFi Security</a></li><li class="content__sections-item content__sections-item--h2"><a href="#transport-encryption-and-kerberos-authentication">Transport Encryption and Kerberos Authentication</a></li><li class="content__sections-item content__sections-item--h2"><a href="#prerequisites">Prerequisites</a></li><li class="content__sections-item content__sections-item--h2"><a href="#configure-transport-encryption">Configure Transport Encryption</a></li><li class="content__sections-item content__sections-item--h2"><a href="#set-up-the-service-account">Set up the service account</a></li><li class="content__sections-item content__sections-item--h2"><a href="#authentication">Authentication</a></li><li class="content__sections-item content__sections-item--h2"><a href="#ca-based-authentication-between-nodes">CA based authentication between nodes</a></li><li class="content__sections-item content__sections-item--h2"><a href="#kerberos-authentication-for-end-users">Kerberos Authentication for End Users</a></li><li class="content__sections-item content__sections-item--h1"><a href="#configuring-dcos-access-for-dcos-nifi">Configuring DC/OS Access for DC/OS NiFi</a></li><li class="content__sections-item content__sections-item--h1"><a href="#provisioning-a-service-account">Provisioning a service account</a></li><li class="content__sections-item content__sections-item--h2"><a href="#prerequisites-3">Prerequisites:</a></li><li class="content__sections-item content__sections-item--h1"><a href="#create-a-key-pair">Create a Key Pair</a></li><li class="content__sections-item content__sections-item--h1"><a href="#create-a-service-account">Create a Service Account</a></li><li class="content__sections-item content__sections-item--h1"><a href="#create-a-secret">Create a Secret</a></li><li class="content__sections-item content__sections-item--h1"><a href="#create-and-assign-permissions">Create and Assign Permissions</a></li><li class="content__sections-item content__sections-item--h2"><a href="#permissive">Permissive</a></li><li class="content__sections-item content__sections-item--h2"><a href="#strict">Strict</a></li></ul></div></aside></main></div></div><script src="/dcosdocs/assets/js/jquery-3.2.1.js"></script><script src="/dcosdocs/assets/js/clipboard.js"></script><script src="/dcosdocs/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>