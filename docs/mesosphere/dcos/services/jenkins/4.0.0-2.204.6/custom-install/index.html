<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Customizing your install - D2iQ Docs</title><meta name="description" content="The Jenkins for DC/OS package accepts a range of custom configuration parameters at install."><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>Jenkins Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/services">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS Services"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/3.6.1-2.190.1/custom-install">Jenkins 3.6.1-2.190.1</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/3.6.0-2.190.1/custom-install">Jenkins 3.6.0-2.190.1</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/3.5.4-2.150.1/custom-install">Jenkins 3.5.4-2.150.1</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/3.5.3-2.150.1/custom-install">Jenkins 3.5.3-2.150.1</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/3.5.2-2.107.2/custom-install">Jenkins 3.5.2-2.107.2</a></li><li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/custom-install">Jenkins for DC/OS</a></li></ul><div class="toggle"><p><span class="title">Jenkins</span><span class="version"> 4.0.0-2.204.6</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/release-notes/">Jenkins for DC/OS Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/options-compatibility-matrix/">Configuration Options Matrix</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/quickstart/">Jenkins for DC/OS Quickstart</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/jenkins-auth/">Provisioning Jenkins for DC/OS</a></li><li class="active active-on"><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/custom-install/">Customizing your install</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/architecture/">Jenkins for DC/OS Service Architecture</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/uninstall/">Uninstalling</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Customizing your install</h1></div><h4 class="content__header-description">The Jenkins for DC/OS package accepts a range of custom configuration parameters at install.</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/custom-install/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><h1 id="about-customizing-your-installation-parameters"><a class="content__anchor" href="#about-customizing-your-installation-parameters" aria-hidden="true"><i data-feather="bookmark"></i></a>About customizing your installation parameters</h1>
<p>The Jenkins for DC/OS package accepts a range of custom configuration parameters at install.</p>
<p>By default, Jenkins for DC/OS uses a <code>/tmp</code> directory on the local host to store its configuration and build data. At a minimum, you should change this before going into production. We recommend setting up a shared file system. Alternatively, you can pin to an agent.</p>
<p>We also expect that you’ll want to customize the default Docker container to add your own dependencies.</p>
<h1 id="using-the-cli"><a class="content__anchor" href="#using-the-cli" aria-hidden="true"><i data-feather="bookmark"></i></a>Using the CLI</h1>
<h2 id="about-using-the-cli"><a class="content__anchor" href="#about-using-the-cli" aria-hidden="true"><i data-feather="bookmark"></i></a>About using the CLI</h2>
<p>You can perform a custom installation from either the web interface or the CLI.</p>
<h2 id="creating-a-json-file"><a class="content__anchor" href="#creating-a-json-file" aria-hidden="true"><i data-feather="bookmark"></i></a>Creating a JSON file</h2>
<ol>
<li>
<p>Create a new file.</p>
<p><strong>Tip:</strong> You might want to choose a pattern like <code>&lt;package-name&gt;-config.json</code>.</p>
<pre><code class="language-bash">nano jenkins-config.json
</code></pre>
</li>
<li>
<p>Use the information in the configuration reference below to build your JSON. This example creates a new Jenkins for DC/OS service named <code>jenkins-myteam</code> and uses the NFS share located at <code>/mnt/nfs/jenkins-data</code>.</p>
<pre><code class="language-json">{
    &quot;service&quot;: {
        &quot;name&quot;: &quot;jenkins-myteam&quot;,
        &quot;storage&quot;: {
            &quot;host-volume&quot;: &quot;/mnt/nfs/jenkins_data&quot;
        }
    }
}
</code></pre>
<p><strong>Tip:</strong> The value of <code>host-volume</code> is the base path to a share on a NFS server or other distributed filesystem. The actual path on-disk for this example is <code>mnt/nfs/jenkins_data/jenkins-myteam</code>.</p>
</li>
<li>
<p>From the CLI, pass the custom options file.</p>
<pre><code class="language-bash">dcos package install jenkins --options=jenkins-config.json
</code></pre>
</li>
</ol>
<h1 id="configuration-reference"><a class="content__anchor" href="#configuration-reference" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuration reference</h1>
<p>The exact configuration can change between releases of the DC/OS Jenkins Service, the following links describe options available for each release.</p>
<ul>
<li><a href="/dcosdocs/mesosphere/dcos/services/jenkins/4.0.0-2.204.6/options-compatibility-matrix/">Jenkins 4.0.0-2.204.6 Configuration options.</a></li>
<li><a href="https://github.com/mesosphere/universe/blob/version-3.x/repo/packages/J/jenkins/100/config.json">Jenkins 3.6.1-2.190.1 Configuration options.</a></li>
<li><a href="https://github.com/mesosphere/universe/blob/version-3.x/repo/packages/J/jenkins/40/config.json">Jenkins 3.6.0-2.190.1 Configuration options.</a></li>
<li><a href="https://github.com/mesosphere/universe/blob/version-3.x/repo/packages/J/jenkins/30/config.json">Jenkins 3.5.4-2.150.1 Configuration options.</a></li>
<li><a href="https://github.com/mesosphere/universe/blob/version-3.x/repo/packages/J/jenkins/29/config.json">Jenkins 3.5.3-2.150.1 Configuration options.</a></li>
<li><a href="https://github.com/mesosphere/universe/blob/version-3.x/repo/packages/J/jenkins/28/config.json">Jenkins 3.5.2-2.107.2 Configuration options.</a></li>
</ul>
<h1 id="examples"><a class="content__anchor" href="#examples" aria-hidden="true"><i data-feather="bookmark"></i></a>Examples</h1>
<h2 id="create-a-new-instance-pinned-to-a-single-host"><a class="content__anchor" href="#create-a-new-instance-pinned-to-a-single-host" aria-hidden="true"><i data-feather="bookmark"></i></a>Create a new instance pinned to a single host</h2>
<p>You can also specify an optional <code>pinned-hostname</code> constraint. This is useful if you don’t have NFS available and need to pin Jenkins to a specific node:</p>
<pre><code class="language-json">{
    &quot;service&quot;: {
        &quot;name&quot;: &quot;jenkins-pinned&quot;,
        &quot;storage&quot;: {
            &quot;host-volume&quot;: &quot;/var/jenkins_data&quot;,
            &quot;pinned-hostname&quot;: &quot;10.0.0.100&quot;
        }
    }
}
</code></pre>
<h2 id="modify-known-hosts"><a class="content__anchor" href="#modify-known-hosts" aria-hidden="true"><i data-feather="bookmark"></i></a>Modify known hosts</h2>
<p>With the <code>known-hosts</code> option you can specify a space-separated list of hostnames from which to retrieve the SSH public keys. This list will be populated on the Jenkins master when the bootstrap script runs (at container launch time). You must manually ensure that the SSH known hosts list is populated in any Jenkins agent containers.</p>
<pre><code class="language-json">{
    &quot;service&quot;: {
        &quot;name&quot;: &quot;jenkins-private-git&quot;,
    },
    &quot;jenkins-master&quot;: {
        &quot;known-hosts&quot;: &quot;github.com git.apache.org git.example.com&quot;
    }
}
</code></pre>
<h2 id="installing-additional-jenkins-plugins"><a class="content__anchor" href="#installing-additional-jenkins-plugins" aria-hidden="true"><i data-feather="bookmark"></i></a>Installing additional Jenkins plugins</h2>
<p>With the <code>additional-plugins</code> option you can specify a space sperated list of addtional Jenkins plugins to be installed into the Jenkins master. This list will be populated on the Jenkins master when the bootstrap script runs (at container launch time).</p>
<pre><code class="language-json">{
    &quot;service&quot;: {
        &quot;name&quot;: &quot;jenkins-additional-plugins&quot;,
    },
    &quot;jenkins-master&quot;: {
        &quot;additional-plugins&quot;: &quot;gradle:1.34 cvs:2.14 handlebars:1.1.1&quot;
    }
}
</code></pre>
<h2 id="using-custom-images-with-pre-installed-jenkins-plugins"><a class="content__anchor" href="#using-custom-images-with-pre-installed-jenkins-plugins" aria-hidden="true"><i data-feather="bookmark"></i></a>Using custom images with pre-installed Jenkins plugins</h2>
<p>DC/OS Jenkins service ships with a minimial list of pre-bundled plugins that are officially supported. The <a href="https://github.com/mesosphere/dcos-jenkins-service/blob/4.0.0-2.204.6/plugins.conf">current list can be found at here</a>.</p>
<p>Customers have the option of specifying an image with a custom list of Jenkins plugins they would like to have pre-installed when the Jenkins service starts up.
This process is diffrent from procedure in <a href="#installing-additional-jenkins-plugins">installing additional plugins</a> as the plugins in this case are bundled into the container image and aren’t downloaded everytime the container gets launched.</p>
<h3 id="creating-a-custom-image-with-bundled-jenkins-plugins"><a class="content__anchor" href="#creating-a-custom-image-with-bundled-jenkins-plugins" aria-hidden="true"><i data-feather="bookmark"></i></a>Creating a custom image with bundled Jenkins plugins</h3>
<p>The process below outlines how to create a custom image with bundled jenkins plugins:</p>
<ol>
<li>Clone the DC/OS Jenkins Github repository<pre><code>git clone https://github.com/mesosphere/dcos-jenkins-service.git
cd dcos-jenkins-service
</code></pre>
</li>
<li>Modify <code>plugins.conf</code> with the list of desired plugins.</li>
<li>Build the docker image. Here we’re using <code>mesosphere/jenkins:custom-image</code> as the example image tag.<pre><code>docker build -t mesosphere/jenkins:custom-image .
</code></pre>
</li>
<li>Push the built image to the respective image repository, we’re using the default Dockerhub in this example.<pre><code>docker push mesosphere/jenkins:custom-image .
</code></pre>
</li>
</ol>
<h3 id="specifying-a-custom-image-at-service-installation-time"><a class="content__anchor" href="#specifying-a-custom-image-at-service-installation-time" aria-hidden="true"><i data-feather="bookmark"></i></a>Specifying a custom image at service installation time</h3>
<p>Once a image has been created with the desired plugins, the custom image can be specified via the options shown below:</p>
<pre><code class="language-json">{
    &quot;service&quot;: {
        &quot;name&quot;: &quot;jenkins-custom-image&quot;,
        &quot;docker-image&quot;: &quot;mesosphere/jenkins:custom-image&quot;
    }
}
</code></pre>
<h2 id="configuring-air-gapped-clusters"><a class="content__anchor" href="#configuring-air-gapped-clusters" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuring Air gapped clusters</h2>
<p>Customers running Jenkins on Air gapped DC/OS clusters should use <a href="/dcosdocs/mesosphere/dcos/latest/administering-clusters/package-registry/">Package Registry</a> to install packages in air gapped environments. Default versions of Jenkins for Package Registry are <a href="https://downloads.mesosphere.com/universe/packages/packages.html">available</a>.</p>
<h3 id="configuring-air-gapped-clusters-with-custom-images"><a class="content__anchor" href="#configuring-air-gapped-clusters-with-custom-images" aria-hidden="true"><i data-feather="bookmark"></i></a>Configuring Air gapped clusters with custom images</h3>
<p>It is possible to also use a <a href="#creating-a-custom-image-with-bundled-jenkins-plugins">custom image</a> with Package Registry, the following instructions outline how to create a Jenkins <code>.dcos</code> file with a custom image.</p>
<ol>
<li>Install <a href="/dcosdocs/mesosphere/dcos/latest/administering-clusters/package-registry/#default-installation">Package Registry</a></li>
<li>Clone the DC/OS Universe repository.<pre><code>https://github.com/mesosphere/universe.git
</code></pre>
</li>
<li>Create a working directory for Package Registry to build the <code>.dcos</code> files.<pre><code>mkdir output-directory
</code></pre>
</li>
<li>Copy the desired version of Jenkins, we’re using <code>jenkins</code> in this example:<pre><code>cp -r universe/tree/version-3.x/repo/packages/B/jenkins/0 output-directory/
</code></pre>
</li>
<li>The folder <code>output-directory</code> should have the following files:<pre><code>config.json
marathon.json.mustache
package.json
resource.json
</code></pre>
</li>
<li>Modify <code>resource.json</code> to use the custom docker image.
Here we’re replacing the default <code>&quot;mesosphere/jenkins:4.0.0-2.204.6&quot;</code> with <code>&quot;mesosphere/jenkins:custom-image&quot;</code>
Modify the <code>docker</code> image to point to the desired custom image, the resulting file looks like the following with the above example:<pre><code class="language-json">{
    &quot;images&quot;: {
        &quot;icon-small&quot;: &quot;https://downloads.mesosphere.com/assets/universe/000/jenkins-icon-small.png&quot;,
        &quot;icon-medium&quot;: &quot;https://downloads.mesosphere.com/assets/universe/000/jenkins-icon-medium.png&quot;,
        &quot;icon-large&quot;: &quot;https://downloads.mesosphere.com/assets/universe/000/jenkins-icon-large.png&quot;
    },
    &quot;assets&quot;: {
        &quot;container&quot;: {
            &quot;docker&quot;: {
                &quot;jenkins&quot;: &quot;mesosphere/jenkins:custom-image&quot;
            }
        }
    }
}
</code></pre>
</li>
<li>Complete building the <code>.dcos</code> files and uploading them to Package Registry by following the procedure to <a href="/dcosdocs/mesosphere/dcos/latest/administering-clusters/package-registry/#building-the-packages">build the packages</a>.</li>
</ol>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#about-customizing-your-installation-parameters">About customizing your installation parameters</a></li><li class="content__sections-item content__sections-item--h1"><a href="#using-the-cli">Using the CLI</a></li><li class="content__sections-item content__sections-item--h2"><a href="#about-using-the-cli">About using the CLI</a></li><li class="content__sections-item content__sections-item--h2"><a href="#creating-a-json-file">Creating a JSON file</a></li><li class="content__sections-item content__sections-item--h1"><a href="#configuration-reference">Configuration reference</a></li><li class="content__sections-item content__sections-item--h1"><a href="#examples">Examples</a></li><li class="content__sections-item content__sections-item--h2"><a href="#create-a-new-instance-pinned-to-a-single-host">Create a new instance pinned to a single host</a></li><li class="content__sections-item content__sections-item--h2"><a href="#modify-known-hosts">Modify known hosts</a></li><li class="content__sections-item content__sections-item--h2"><a href="#installing-additional-jenkins-plugins">Installing additional Jenkins plugins</a></li><li class="content__sections-item content__sections-item--h2"><a href="#using-custom-images-with-pre-installed-jenkins-plugins">Using custom images with pre-installed Jenkins plugins</a></li><li class="content__sections-item content__sections-item--h2"><a href="#configuring-air-gapped-clusters">Configuring Air gapped clusters</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>