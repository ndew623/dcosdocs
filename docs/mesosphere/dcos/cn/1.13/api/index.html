<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>API 参考 - D2iQ Docs</title><meta name="description" content="DC/OS API 参考手册"><link rel="apple-touch-icon" sizes="180x180" href="/dcosdocs/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/dcosdocs/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/dcosdocs/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/dcosdocs/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/dcosdocs/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/dcosdocs/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS文档</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="spherer"><div class="chooser-current"><a class="chooser-title">Mesosphere</a><svg class="chooser-svg" id="spherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="spherer-list"><li class="chooser-list-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li></ul></div><div class="chooser" id="ks"><div class="chooser-current"><a class="chooser-title">DKP</a><svg class="chooser-svg" id="kspherer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="kspherer-list"><li class="chooser-list-item"><a href="/dkp/konvoy">Konvoy</a></li><li class="chooser-list-item"><a href="/dkp/konvoy/partner-solutions">Partner Solutions</a></li><li class="chooser-list-item"><a href="/dkp/kommander">Kommander</a></li><li class="chooser-list-item"><a href="/dkp/dispatch">Dispatch</a></li><li class="chooser-list-item"><a href="/dkp/kaptain">Kaptain</a></li><li class="chooser-list-item"><a href="/dkp/conductor">Conductor</a></li></ul></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">中文 (简体)</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/1.13/api">English</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 1.13"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/konvoy/partner-solutions">Partner Solutions</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__item"><a href="/dkp/conductor">Conductor</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/cn/2.1/api">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/cn/2.0/api">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/cn/1.13/api">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 1.13</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/release-notes/"><i data-feather="chevron-right"></i>版本注释</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/overview/"><i data-feather="chevron-right"></i>概述</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/installing/"><i data-feather="chevron-right"></i>安装</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/administering-clusters/"><i data-feather="chevron-right"></i>管理群集</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/networking/"><i data-feather="chevron-right"></i>网络</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/security/"><i data-feather="chevron-right"></i>安全</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/storage/"><i data-feather="chevron-right"></i>存储</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/metrics/"><i data-feather="chevron-right"></i>度量标准</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/monitoring/"><i data-feather="chevron-right"></i>监控、日志记录和调试</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/hybrid-cloud/"><i data-feather="chevron-right"></i>混合云</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/deploying-jobs/"><i data-feather="chevron-right"></i>部署作业</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/deploying-services/"><i data-feather="chevron-right"></i>部署服务和 Pod</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/tutorials/"><i data-feather="chevron-right"></i>教程</a></li><li class="active active-on"><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/"><i data-feather="chevron-right"></i>API 参考</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/access/">群集访问</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/versioning/">API 版本控制</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/master-routes/">管理节点路由</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/agent-routes/">代理路由</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/cn/1.13/developing-services/"><i data-feather="chevron-right"></i>开发 DC/OS 服务</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2021 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">API 参考</h1><p class="badge badge--content-header badge--enterprise">ENTERPRISE</p></div><h4 class="content__header-description">DC/OS API 参考手册</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/cn/1.13/api/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li><li class="actions__item"><a class="actions__link" href="https://jira.d2iq.com/secure/CreateIssueDetails!init.jspa?pid=14105&amp;issuetype=1&amp;summary=Feedback+for+API+参考&amp;description=Source:%20https://docs.d2iq.com/dcosdocs/mesosphere/dcos/cn/1.13/api&amp;labels=documentation&amp;labels=needs_triage&amp;components=19804&amp;priority=3&amp;customfield_12300=44" target="_blank"><i class="actions__icon" data-feather="message-square"></i><span class="actions__text">Feedback</span></a></li></ul></div></div><article class="content__article"><p>配置为可以使用 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/overview/architecture/components/"><code>ListenAddress</code></a> 支持的路由集合，通过名为 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/overview/architecture/components/#admin-router">Admin Router</a>.的 API 网关提供。</p>
<img src="/1.13/img/dcos-api-routing.png" alt="DC/OS API Routing" style="display:block;margin:0 auto"/>
图 1. DC/OS API 路由示意图
<h1 id="api"><a class="content__anchor" href="#api" aria-hidden="true"><i data-feather="bookmark"></i></a>API 网关</h1>
<p>Admin Router 是基于 NGINX 的 API 网关，具有以下功能：</p>
<ul>
<li>为 DC/OS API 提供统一控制平面</li>
<li>代理 API 对管理节点和代理节点的组件服务的请求</li>
<li>执行用户身份认证</li>
<li>提供 DC/OS GUI</li>
</ul>
<p>Admin Router 在每个 DC/OS 节点上运行，其有如下两种配置：</p>
<ul>
<li>
<p><strong>Admin Router 管理节点</strong> 公开 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/api/master-routes/">管理节点路由</a>. 此配置在每个管理节点上运行，用作与 DC/OS 组件交互的主 API 网关。</p>
</li>
<li>
<p><strong>Admin Router 代理节点</strong> 公开 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/api/agent-routes/">代理路由</a>. 此配置在每个代理节点上运行，并提供用于监视、调试和管理的路由。</p>
</li>
</ul>
<p>某些代理路由，如日志和度量标准，通过管理节点 Admin Router 代理以允许外部访问。
其他路由，如组件管理，仅供内部使用。</p>
<h1 id=""><a class="content__anchor" href="#" aria-hidden="true"><i data-feather="bookmark"></i></a>路由类型</h1>
<p>Admin Router 公开若干路由类型：</p>
<ul>
<li><strong>代理路由</strong> 从另一个 URL 检索资源。</li>
<li><strong>文件路由</strong> 检索静态文件。</li>
<li><strong>Lua 路由</strong> 执行 Lua 代码以生成响应。</li>
<li><strong>重定向路由</strong> 重定向到另一个 URL。</li>
<li><strong>重写路由</strong> 将路由转换为其他路由。</li>
</ul>
<h1 id="-2"><a class="content__anchor" href="#-2" aria-hidden="true"><i data-feather="bookmark"></i></a>群集访问</h1>
<p>要确定群集的 URL，请参阅 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/api/access/">群集访问</a>.</p>
<h1 id="-3"><a class="content__anchor" href="#-3" aria-hidden="true"><i data-feather="bookmark"></i></a>版本控制</h1>
<p>DC/OS API 部分按组件、路由或资源进行版本控制。有关版本控制机制的详细信息，请参阅<a href="/dcosdocs/mesosphere/dcos/cn/1.13/api/versioning/">版本控制</a>.</p>
<h1 id="-4"><a class="content__anchor" href="#-4" aria-hidden="true"><i data-feather="bookmark"></i></a>验证</h1>
<p>某些路由未经过身份认证，但大多数路由都需要认证令牌。有关如何获取和使用认证令牌的详细信息，请参阅 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/ent/iam-api/">验证 HTTP API 端点</a>.</p>
<h1 id="-5"><a class="content__anchor" href="#-5" aria-hidden="true"><i data-feather="bookmark"></i></a>授权</h1>
<p>大多数认证路由也需要通过权限授权。DC/OS Enterprise 中的权限包含分层资源标识符和操作（创建、读取、更新、删除、全部）。权限执行可以在两个级别执行。</p>
<ul>
<li><strong>粗粒度权限</strong> 是在路由级别 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/ent/perms-reference/#admin-router">由 Admin Router 执行</a></li>
<li><strong>细粒度权限</strong> 由单个后端组件服务执行。</li>
</ul>
<p><a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/ent/perms-management/">权限管理</a>可通过具有 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/ent/perms-reference/#superuser">超级用户权限</a> 的用户使用 <a href="/dcosdocs/mesosphere/dcos/cn/1.13/security/ent/iam-api/">身份和访问管理 API</a>.执行。具有超级用户权限的用户也有隐式权限访问所有路由。</p>
<h1 id="-6"><a class="content__anchor" href="#-6" aria-hidden="true"><i data-feather="bookmark"></i></a>路由使用</h1>
<ul>
<li>
<p><strong>代理路由</strong>  要通过 <strong>代理路由</strong>确定一个 API 资源的完整 URL，连接群集 URL、路由和后端组件资源路径。</p>
<pre><code>&lt;cluster-url&gt;/&lt;route&gt;/&lt;resource-path&gt;
</code></pre>
<p>例如，从以下获取 Mesos 版本：<code>https://dcos.example.com/mesos/version</code></p>
</li>
<li>
<p><strong>文件路由</strong> 没有后端组件，但可能提供多个文件或单个文件的目录。因此，对于文件路由，指定文件路径，而不是后端组件资源路径。</p>
<pre><code>&lt;cluster-url&gt;/&lt;route&gt;/&lt;file-path&gt;
</code></pre>
<p>例如，从以下获取群集的 DC/OS 版本：<code>https://dcos.example.com/dcos-metadata/dcos-version.json</code></p>
</li>
<li>
<p><strong>Lua 路由</strong> 立即在 Admin Router 中执行代码，而不是以代理的方式路由到外部后端组件。对于 Lua 路由，路由后无需路径。</p>
<pre><code>&lt;cluster-url&gt;/&lt;route&gt;
</code></pre>
<p>例如，从以下获取管理节点的公用 IP 和群集 ID：<code>https://dcos.example.com/metadata</code></p>
</li>
<li>
<p><strong>重写和重定向路由</strong>可能会在返回资源之前穿过一个或多个其他 URL 或路由。因此，对于这些路由，请遵循 URL 和路由链以查找端点。资源路径将取决于最终端点。</p>
</li>
</ul>
<p>大多数重写和重定向在另一个 DC/OS API 路由上终止， 但是明显的例外是<code>/login</code>，它使用 OpenID Connect 和外部身份提供程序进行授权，然后重定向回 DC/OS API。</p>
<div class="grid"><a class="grid__item" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/access"><div class="grid__header__wrapper"><h3 class="grid__header">群集访问</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">获取群集 URL 的访问权限<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/versioning"><div class="grid__header__wrapper"><h3 class="grid__header">API 版本控制</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">理解组件、资源和路由版本控制<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/master-routes"><div class="grid__header__wrapper"><h3 class="grid__header">管理节点路由</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">在 DC/OS 管理节点上运行的 Admin Router<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a><a class="grid__item" href="/dcosdocs/mesosphere/dcos/cn/1.13/api/agent-routes"><div class="grid__header__wrapper"><h3 class="grid__header">代理路由</h3></div><div class="grid__desc__wrapper"><p class="grid__desc">在 DC/OS 代理节点上运行的 Admin Router。<span class="grid__desc__ellipsis">&#8230;Read More</span></p></div><div class="grid__link"><i data-feather="arrow-right"></i></div></a></div></article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#api">API 网关</a></li><li class="content__sections-item content__sections-item--h1"><a href="#路由类型">路由类型</a></li><li class="content__sections-item content__sections-item--h1"><a href="#-2">群集访问</a></li><li class="content__sections-item content__sections-item--h1"><a href="#-3">版本控制</a></li><li class="content__sections-item content__sections-item--h1"><a href="#-4">验证</a></li><li class="content__sections-item content__sections-item--h1"><a href="#-5">授权</a></li><li class="content__sections-item content__sections-item--h1"><a href="#-6">路由使用</a></li></ul></div></aside></main></div></div><script src="/dcosdocs/assets/js/jquery-3.2.1.js"></script><script src="/dcosdocs/assets/js/clipboard.js"></script><script src="/dcosdocs/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>