<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Configuring GPU nodes - D2iQ Docs</title><meta name="description" content="Adding Graphics Processing Units to long-running DC/OS services"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/dcosdocs/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/2.1/installing/production/advanced-configuration/configuring-gpu-nodes">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 2.1"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/2.2/installing/production/advanced-configuration/configuring-gpu-nodes">Mesosphere DC/OS 2.2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuring-gpu-nodes">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.0/installing/production/advanced-configuration/configuring-gpu-nodes">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/1.13/installing/production/advanced-configuration/configuring-gpu-nodes">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 2.1</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/overview/"><i data-feather="chevron-right"></i>Overview</a></li><li class="active"><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/installing/"><i data-feather="chevron-right"></i>Installing</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/installing/evaluation/"><i data-feather="chevron-right"></i>Cloud Installation</a></li><li class="active"><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/"><i data-feather="chevron-right"></i>On-Prem Installation</a></li><ul><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/virt-infra/">Virtual Infrastructure</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/system-requirements/"><i data-feather="chevron-right"></i>System Requirements</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/deploying-dcos/"><i data-feather="chevron-right"></i>Deploying DC/OS</a></li><li class="active"><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/"><i data-feather="chevron-right"></i>Advanced Configuration</a></li><ul><li><a class="d3" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuration-reference/">Configuration Reference</a></li><li class="active active-on"><a class="d3" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuring-gpu-nodes/">Configuring GPU nodes</a></li><li><a class="d3" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuring-zones-regions/"><i data-feather="chevron-right"></i>Configuring Zones and Regions</a></li></ul><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/dcos-ansible/"><i data-feather="chevron-right"></i>DC/OS with Ansible</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/patching/">Patching</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/upgrading/">Upgrading</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/2.1/installing/production/uninstalling/">Uninstalling</a></li></ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/installing/installation-faq/">Frequently Asked Questions</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/2.1/installing/troubleshooting/">Troubleshooting</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/multi-tenancy/"><i data-feather="chevron-right"></i>Multi-Tenancy for DC/OS Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/2.1/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container content__container--with-sections"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Configuring GPU nodes</h1></div><h4 class="content__header-description">Adding Graphics Processing Units to long-running DC/OS services</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuring-gpu-nodes/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><p>DC/OS supports allocating GPUs (Graphics Processing Units) to your long-running DC/OS services. Adding GPUs to your services can dramatically accelerate big data workloads.</p>
<p>With GPU-based scheduling, you can share cluster resources for traditional and machine learning workloads, as well as dynamically allocate GPU resources inside those clusters and free them when needed. You can reserve GPU resources for the workloads that need them, or pool these GPU-enabled resources with the rest of the infrastructure for higher overall utilization.</p>
<p>After installing DC/OS with GPUs enabled, you can specify GPUs in your application definitions with the <code>gpus</code> parameter.</p>
<h1 id="installing-dcos-with-gpus-enabled"><a class="content__anchor" href="#installing-dcos-with-gpus-enabled" aria-hidden="true"><i data-feather="bookmark"></i></a>Installing DC/OS with GPUs Enabled</h1>
<p>GPUs must be enabled during DC/OS installation. Follow the instructions below to enable GPUs based on your specific DC/OS deployment method.</p>
<h2 id="custom-dcos-installation-with-gpus"><a class="content__anchor" href="#custom-dcos-installation-with-gpus" aria-hidden="true"><i data-feather="bookmark"></i></a>Custom DC/OS Installation with GPUs</h2>
<ol>
<li>
<p>Install the <a href="https://developer.nvidia.com/nvidia-management-library-nvml">NVIDIA Management Library (NVML)</a> on each node of your cluster that has GPUs. The minimum required NVIDIA driver version is 340.29. For detailed installation instructions, see the <a href="http://mesos.apache.org/documentation/latest/gpu-support/#external-dependencies">Mesos GPU support documentation</a>.</p>
</li>
<li>
<p>Install DC/OS using the <a href="/dcosdocs/mesosphere/dcos/2.1/installing/production/deploying-dcos/installation/">custom advanced installation instructions</a>. Here are the GPU-specific configuration parameters:</p>
<ul>
<li><strong><code>enable_gpu_isolation</code></strong>: Indicates whether to enable GPU support in DC/OS. By default, this is set to <code>enable_gpu_isolation: 'true'</code>.</li>
<li><strong><code>gpus_are_scarce</code></strong>: Indicates whether to treat GPUs as a scarce resource in the cluster. By default, this is set to <code>gpus_are_scarce: 'true'</code>, which means DC/OS reserves GPU nodes exclusively for services that are configured to consume GPU resources. It’s important to note that this setting will influence which agent nodes a GPU-aware framework will be deployed on DC/OS. This setting does not influence the individual tasks which the frameworks might launch while the framework is running. It is possible for a framework to schedule a non-GPU task on an agent node where GPU’s are present.</li>
</ul>
<p>For more information, see the <a href="/dcosdocs/mesosphere/dcos/2.1/installing/production/advanced-configuration/configuration-reference/#enable-gpu-isolation">configuration parameter documentation</a> and Mesos <a href="http://mesos.apache.org/documentation/latest/gpu-support/#external-dependencies">Nvidia GPU Support documentation</a>.</p>
</li>
</ol>
<h2 id="aws-ec2-dcos-installation-with-gpus"><a class="content__anchor" href="#aws-ec2-dcos-installation-with-gpus" aria-hidden="true"><i data-feather="bookmark"></i></a>AWS EC2 DC/OS Installation with GPUs</h2>
<h3 id="prerequisites"><a class="content__anchor" href="#prerequisites" aria-hidden="true"><i data-feather="bookmark"></i></a>Prerequisites</h3>
<ul>
<li>The AWS DC/OS advanced template <a href="/dcosdocs/mesosphere/dcos/2.1/installing/evaluation/community-supported-methods/aws/">system requirements</a>.</li>
<li>The <code>zen.sh</code> script copied to your local machine. The script and instructions are <a href="/dcosdocs/mesosphere/dcos/2.1/installing/evaluation/community-supported-methods/aws/">here</a>.</li>
</ul>
<h3 id="create-dependencies"><a class="content__anchor" href="#create-dependencies" aria-hidden="true"><i data-feather="bookmark"></i></a>Create Dependencies</h3>
<ol>
<li>Run the <code>zen.sh</code> script to create the Zen template dependencies. These dependencies will be used as input to create your stack in CloudFormation.</li>
</ol>
<pre><code>bash ./zen.sh &lt;stack-name&gt;
</code></pre>
   <p class="message--important"><strong>IMPORTANT: </strong>You must run the <code>zen.sh</code> script before performing the next steps.</p>
<ol start="2">
<li>
<p>Follow the instructions <a href="/dcosdocs/mesosphere/dcos/2.1/installing/evaluation/community-supported-methods/aws/">here</a> to create a cluster with advanced AWS templates, using the following GPU-specific configuration.</p>
</li>
<li>
<p>On the <strong>Create Stack</strong> &gt; <strong>Specify Details</strong> page, specify your stack information and click <strong>Next</strong>. Here are the GPU-specific settings.</p>
<ul>
<li>
<p><strong>CustomAMI</strong> - Specify the custom AMI for your region:</p>
<ul>
<li>us-west-2: <code>ami-d54a2cad</code></li>
<li>us-east-1: <code>ami-5f5d1449</code></li>
<li>ap-southeast-2: <code>ami-0d50476e</code></li>
</ul>
</li>
<li>
<p><strong>MasterInstanceType</strong> - Accept the default master instance type (For example, <code>m3.xlarge</code>).</p>
</li>
<li>
<p><strong>PrivateAgentInstanceType</strong> - Specify an <a href="https://aws.amazon.com/ec2/instance-types/#p2">AWS GPU machine type</a> (For example, <code>g2.2xlarge</code>).</p>
</li>
<li>
<p><strong>PublicAgentInstanceType</strong> - Specify an <a href="https://aws.amazon.com/ec2/instance-types/#p2">AWS GPU machine type</a> (For example, <code>g2.2xlarge</code>).</p>
</li>
</ul>
</li>
<li>
<p>On the <strong>Options</strong> page, accept the defaults and click <strong>Next</strong>. You can choose whether to roll back on failure. By default this option is set to <strong>Yes</strong>.</p>
</li>
<li>
<p>On the <strong>Review</strong> page, check the acknowledgement box, then click <strong>Create</strong>.</p>
<p class="message--note"><strong>NOTE: </strong>If the <strong>Create New Stack</strong> page is shown, either AWS is still processing your request or you’re looking at a different region. Navigate to the correct region and refresh the page to see your stack.</p>
</li>
</ol>
</article></div><aside class="content__sections"><div class="content__sections-list-container"><ul class="content__sections-list"><li class="content__sections-item content__sections-item--h1"><a href="#installing-dcos-with-gpus-enabled">Installing DC/OS with GPUs Enabled</a></li><li class="content__sections-item content__sections-item--h2"><a href="#custom-dcos-installation-with-gpus">Custom DC/OS Installation with GPUs</a></li><li class="content__sections-item content__sections-item--h2"><a href="#aws-ec2-dcos-installation-with-gpus">AWS EC2 DC/OS Installation with GPUs</a></li></ul></div></aside></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>