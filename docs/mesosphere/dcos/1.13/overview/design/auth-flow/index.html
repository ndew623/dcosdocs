<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width" initial-scale="1" user-scalable="no"><title>Authentication Architecture - D2iQ Docs</title><meta name="description" content="Understanding authentication operations"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="stylesheet" type="text/css" href="/dcosdocs/css/styles.css"><link rel="search" type="application/opensearchdescription+xml" href="/assets/opensearch.xml" title="Search"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"><script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script><script>window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("7sgtwqvuai");
window.analytics.page();</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PBJ84KX" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PBJ84KX');</script></head><body><div class="layout"><header class="header"><a class="header__drawer"><i class="header__icon" data-feather="menu"></i></a><a class="header__logo" href="/"><img class="header__logo--mobile" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"><img class="header__logo--desktop" src="/assets/D2iQ_Logotype_Color_Positive_Documentation.svg" alt="D2IQ"></a><div class="header__main"><div class="header__dropdown"><img class="header__dropdown-icon" src="/assets/D2IQ_Logotype_Color_Positive.png" alt="D2iQ"><strong>DC/OS Documentation</strong><i data-feather="chevron-down"></i></div><nav class="header__menu"><ul class="header__menu-list"><li class="header__menu-item"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header__menu-item"><a href="/dcosdocs/mesosphere/dcos/services">Services</a></li><li class="header__menu-item"><a href="https://support.d2iq.com">Support</a></li></ul></nav></div><div class="chooser" id="localizer"><div class="chooser-current"><a class="chooser-title">English</a><svg class="chooser-svg" id="localizer-svg"><path class="pointer" d="m 13,6 -5,5 -5,-5 z" fill="#858585"></path></svg></div><ul class="chooser-list" id="localizer-list"><li class="chooser-list-item"><a href="/dcosdocs/mesosphere/dcos/cn/1.13/overview/design/auth-flow">中文 (简体)</a></li></ul></div><section class="header__search" role="search"><form class="header__search-form" action="/search/"><input class="header__search-input" id="header-search-input" tabindex="1" type="text" name="q" placeholder="Search"><input type="hidden" name="hFR[scope][0]" value="DC/OS 1.13"><label class="header__search-label" for="header-search-input"><i class="header__icon" data-feather="search"></i></label></form></section></header><div class="header-dropdown"><ul class="header-dropdown__list"><li class="header-dropdown__top-item"><div>DKP</div></li><li class="header-dropdown__item"><a href="/dkp/konvoy">Konvoy</a></li><li class="header-dropdown__item"><a href="/dkp/kommander">Kommander</a></li><li class="header-dropdown__item"><a href="/dkp/dispatch">Dispatch</a></li><li class="header-dropdown__item"><a href="/dkp/kaptain">Kaptain</a></li><li class="header-dropdown__top-item"><div>Mesosphere</div></li><li class="header-dropdown__item header-dropdown__item--active"><a href="/mesosphere/dcos">DC/OS</a></li><li class="header-dropdown__item"><a href="/dcosdocs/mesosphere/dcos/services">DC/OS Services</a></li><li class="header-dropdown__item"><a href="https://support.d2iq.com">Support</a></li></ul></div><div class="layout__sidebar layout__drawer"><section class="sidebar"><header class="sidebar__header"><div class="sidebar__dropdown"><ul><li><a href="/dcosdocs/mesosphere/dcos/2.2/overview/design/auth-flow">Mesosphere DC/OS 2.2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.1/overview/design/auth-flow">Mesosphere DC/OS 2.1.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/2.0/overview/design/auth-flow">Mesosphere DC/OS 2.0</a></li><li><a href="/dcosdocs/mesosphere/dcos/1.13/overview/design/auth-flow">Mesosphere DC/OS 1.13</a></li></ul><div class="toggle"><p><span class="title">DC/OS</span><span class="version"> 1.13</span></p><i data-feather="chevron-down"></i></div></div></header><nav class="sidebar_nav" role="navigation"><ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/release-notes/"><i data-feather="chevron-right"></i>Release Notes</a></li><li class="active"><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/overview/"><i data-feather="chevron-right"></i>Overview</a></li><ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/what-is-dcos/">What is DC/OS</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/architecture/"><i data-feather="chevron-right"></i>Architecture</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/features/">Features</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/concepts/">Concepts</a></li><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/high-availability/">High Availability</a></li><li class="active"><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/"><i data-feather="chevron-right"></i>Design</a></li><ul><li class="active active-on"><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/auth-flow/">Authentication Architecture</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/azure-container-service/">ACS</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/dns-proxy/">Distributed DNS</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/installation/">Installation</a></li><li><a class="d2" href="/dcosdocs/mesosphere/dcos/1.13/overview/design/overlay/">Overlay</a></li></ul><li><a class="d1" href="/dcosdocs/mesosphere/dcos/1.13/overview/feature-maturity/">Feature Maturity</a></li></ul><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/installing/"><i data-feather="chevron-right"></i>Installing</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/gui/"><i data-feather="chevron-right"></i>GUI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/cli/"><i data-feather="chevron-right"></i>CLI</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/administering-clusters/"><i data-feather="chevron-right"></i>Administering Clusters</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/networking/"><i data-feather="chevron-right"></i>Networking</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/security/"><i data-feather="chevron-right"></i>Security</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/storage/"><i data-feather="chevron-right"></i>Storage</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/metrics/"><i data-feather="chevron-right"></i>Metrics</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/monitoring/"><i data-feather="chevron-right"></i>Monitoring, Logging, and Debugging</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/hybrid-cloud/"><i data-feather="chevron-right"></i>Hybrid Cloud</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/deploying-jobs/"><i data-feather="chevron-right"></i>Deploying Jobs</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/deploying-services/"><i data-feather="chevron-right"></i>Deploying Services and Pods</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/tutorials/"><i data-feather="chevron-right"></i>Tutorials</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/api/"><i data-feather="chevron-right"></i>API Reference</a></li><li><a class="d0" href="/dcosdocs/mesosphere/dcos/1.13/developing-services/"><i data-feather="chevron-right"></i>Developing DC/OS Services</a></li></ul></nav><footer class="sidebar__footer"><div class="sidebar__footer-links"><a href="https://d2iq.com/terms/">Terms of Service</a><a href="https://d2iq.com/privacy/">Privacy Policy</a></div><a class="sidebar__footer-copyright" href="https://d2iq.com/">&copy; 2022 D2iQ, Inc. All rights reserved.</a></footer></section></div><div class="layout__content" role="main"><main class="content"><div class="content__container"><div class="content__header"><div class="content__header__row"><h1 class="content__header-title">Authentication Architecture</h1></div><h4 class="content__header-description">Understanding authentication operations</h4><div class="actions"><ul class="actions__list"><li class="actions__item"><button class="actions__link" onclick="javascript:window.print()"><i class="actions__icon" data-feather="printer"></i><span class="actions__text">Print</span></button></li><li class="actions__item"><a class="actions__link" href="https://github.com/mesosphere/dcos-docs-site/tree/main/pages/dcosdocs/mesosphere/dcos/1.13/overview/design/auth-flow/index.md" target="_blank"><i class="actions__icon" data-feather="github"></i><span class="actions__text">Contribute</span></a></li></ul></div></div><article class="content__article"><p>An authentication operation via the DC/OS UI proceeds as follows:</p>
<ol>
<li>Open the cluster front page URL in your browser.</li>
<li>If you have a valid <a href="/dcosdocs/mesosphere/dcos/2.0/security/oss/authentication/authentication-token/">authentication token</a> cookie (checked by Admin Router) you may proceed to the cluster front page. If not, you are redirected to the login page.</li>
<li>The login page in the DC/OS UI loads the login page at <code>dcos.auth0.com</code> in an iframe, which presents you with a choice of identity providers, including Google, GitHub, and Microsoft account.</li>
<li>Select an identity provider and complete the OAuth protocol flow in a popup window that returns an RS256-signed JWT for you. This user token is currently issued to be valid for five days, based on the standard <code>exp</code> claim.</li>
<li>The login page dispatches a request with your user token to the <code>http://&lt;master-host-name&gt;/acs/api/v1/auth/login</code> Admin Router endpoint which forwards it to the <a href="https://github.com/dcos/dcos-oauth">dcos-oauth</a> service. If you are the first user accessing the cluster, an account is automatically created. Any subsequent users must be added by any other user in the cluster as described in the <a href="/dcosdocs/mesosphere/dcos/1.13/security/oss/user-account-management/">User Management</a> page. If the user logging into the cluster is determined to be valid, they are issued an HS256-signed JWT containing a <code>uid</code> claim, which is specific to the cluster they are logging in to.</li>
</ol>
<p>For the <code>dcos-oauth</code> service to validate tokens it receives during login operations,
it must have access to <code>dcos.auth0.com</code> to fetch required public keys via
HTTPS. Use of a proxy to make this request is not currently supported.</p>
<p>The shared secret used to sign the cluster-specific tokens with the HS256
algorithm is generated during cluster boot and stored at
<code>/var/lib/dcos/auth-token-secret</code> on each master node and in the
<code>/dcos/auth-token-secret</code> znode in ZooKeeper.</p>
<p>As noted above, to ease the setup process, DC/OS automatically adds the first
user that logs in to the DC/OS cluster. Be sure to restrict network
access to the cluster until the first user has been configured.</p>
<p>Be sure to protect authentication tokens, as an unauthorized
third party may use them to log in to your cluster if obtained. Invalidation
of individual tokens is not currently supported. In case a token is exposed,
it is recommended that the affected user be removed from the cluster.</p>
<p>The <a href="https://jwt.io">JWT.IO</a> service can be used to decode JWTs to inspect
their contents.</p>
</article></div></main></div></div><script src="/assets/js/jquery-3.2.1.js"></script><script src="/assets/js/clipboard.js"></script><script src="/assets/js/prism.js"></script><script src="/js/main.js"></script></body></html>